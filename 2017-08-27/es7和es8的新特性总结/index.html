<!DOCTYPE html><html lang=en><head><meta charset=utf-8><meta name=viewport content="width=device-width,initial-scale=1,maximum-scale=1,minimum-scale=1,user-scalable=no"><meta name=keywords content=blog,html,css,javascript,react,vue,nodejs><meta name=description content="zoubingwu 个人博客, zoubingwu's blog"><link href=/assets/images/favicon.ico rel=bookmark type=image/x-icon><link href=/assets/images/favicon.ico rel=icon type=image/x-icon><link href=/assets/images/favicon.ico rel="shortcut icon" type=image/x-icon><link rel=stylesheet href=/assets/css/main.css type=text/css><link rel=preload href=https://cdn.jsdelivr.net/npm/lxgw-wenkai-lite-webfont@1.6.0/style.css as=style><link rel=preload href=https://cdn.bootcdn.net/ajax/libs/font-awesome/4.7.0/css/font-awesome.min.css as=style><link rel=stylesheet href=https://cdn.bootcdn.net/ajax/libs/font-awesome/4.7.0/css/font-awesome.min.css as=style><link rel=stylesheet href=https://cdn.jsdelivr.net/npm/lxgw-wenkai-lite-webfont@1.6.0/style.css><link rel=alternate type=application/rss+xml title="RSS Feed for zoubingwu's blog" href=/feed.xml><title>ES7和ES8的新特性总结 | https://zoubingwu.com</title><meta property=og:title content="ES7和ES8的新特性总结 | https://zoubingwu.com"><meta property=og:locale content=en_US><meta name=description content="眨眼间2017年已经过去了三分之二，TC39也一直继续推进着ECMAScript的新标准，这篇文章来总结一些ES7和ES8(ES2016/ES2017 officially)的新特性，还好它们比ES6的内容要少很多。"><meta property=og:description content="眨眼间2017年已经过去了三分之二，TC39也一直继续推进着ECMAScript的新标准，这篇文章来总结一些ES7和ES8(ES2016/ES2017 officially)的新特性，还好它们比ES6的内容要少很多。"><link rel=canonical href=https://zoubingwu.com/2017-08-27/es7和es8的新特性总结><meta property=og:url content=https://zoubingwu.com/2017-08-27/es7和es8的新特性总结><meta property=og:site_name content="zoubingwu's blog"><meta property=og:type content=article><meta property=article:published_time content=2017-08-27T11:20:33.000Z><meta name=twitter:card content=summary><meta property=twitter:title content="ES7和ES8的新特性总结 | https://zoubingwu.com"><script>(function (i, s, o, g, r, a, m) { i['GoogleAnalyticsObject'] = r; (i[r] = i[r]
  || function () { (i[r].q = i[r].q || []).push(arguments); }), (i[r].l = 1 *
  new Date()); (a = s.createElement(o)), (m = s.getElementsByTagName(o)[0]);
  a.async = 1; a.src = g; m.parentNode.insertBefore(a, m); })( window, document,
  'script', 'https://www.google-analytics.com/analytics.js', 'ga' );
  ga('create', 'UA-100363260-1', 'auto'); ga('send', 'pageview');</script><script defer=defer data-domain=zoubingwu.com src=https://plausible.io/js/script.js></script></head><body><div class=content-container><div class=post><div class=post-title>ES7和ES8的新特性总结</div><span class=post-date><time>27 Aug 2017</time></span><div class=post-tag><ul><li><a><span><i class="fa fa-paperclip" aria-hidden=true></i>javascript</span></a></li></ul></div><p>根据 <a href=https://github.com/tc39/proposals/blob/master/finished-proposals.md>https://github.com/tc39/proposals/blob/master/finished-proposals.md</a>，最后一次更新在8月4号，已经达到 stage 4 完成的提案有下面这些：</p><ol><li><code>Array.prototype.includes</code></li><li>Exponentiation Operator</li><li><code>Object.values</code> / <code>Object.entries</code></li><li>String padding</li><li><code>Object.getOwnPropertyDescriptors</code></li><li>Trailing commas in function parameter lists and calls</li><li>Async functions</li><li>Shared memory and atomics</li><li>Lifting template literal restriction</li></ol><h2 id=arrayprototypeincludes><code>Array.prototype.includes</code></h2><p>之前我们经常使用 <code>indexOf</code> 来检查数组中是否存在某个值，但尴尬的是它返回来的是 -1 或者值的位置，并不是一个布尔值，因此我们经常在代码上需要转换一下，这在逻辑上是并不明确的，比如如果不存在某个值，返回的 -1 其实是一个真值(truthy)，而如果值的位置在首位，那么返回的 0 又是一个假值(falsey)，导致我们只能写成：</p><pre><code class=language-js><pre class=shiki style="background-color: #282c34"><code><span class=line><span style="color: #C678DD">if</span><span style="color: #ABB2BF"> (</span><span style="color: #E5C07B">arr</span><span style="color: #ABB2BF">.</span><span style="color: #61AFEF">indexOf</span><span style="color: #ABB2BF">(</span><span style="color: #98C379">&#39;xxx&#39;</span><span style="color: #ABB2BF">) </span><span style="color: #56B6C2">!==</span><span style="color: #ABB2BF"> </span><span style="color: #56B6C2">-</span><span style="color: #D19A66">1</span><span style="color: #ABB2BF">) {</span></span>
<span class=line><span style="color: #ABB2BF">  </span><span style="color: #7F848E; font-style: italic">// some code</span></span>
<span class=line><span style="color: #ABB2BF">}</span></span></code></pre>
</code></pre><p>作为 <code>indexOf</code> 方法的替代，以后我们就可以这么写：</p><pre><code class=language-js><pre class=shiki style="background-color: #282c34"><code><span class=line><span style="color: #C678DD">if</span><span style="color: #ABB2BF"> (</span><span style="color: #E5C07B">arr</span><span style="color: #ABB2BF">.</span><span style="color: #61AFEF">includes</span><span style="color: #ABB2BF">(</span><span style="color: #98C379">&#39;xxx&#39;</span><span style="color: #ABB2BF">)) {</span></span>
<span class=line><span style="color: #ABB2BF">  </span><span style="color: #7F848E; font-style: italic">// some code</span></span>
<span class=line><span style="color: #ABB2BF">}</span></span></code></pre>
</code></pre><p>使得代码语义上的可读性更强了。另外这个方法也可以用在 string 上。对于 NaN，这个方法一样可以识别：</p><pre><code class=language-js><pre class=shiki style="background-color: #282c34"><code><span class=line><span style="color: #ABB2BF">[</span><span style="color: #D19A66">1</span><span style="color: #ABB2BF">, </span><span style="color: #D19A66">2</span><span style="color: #ABB2BF">, </span><span style="color: #D19A66">NaN</span><span style="color: #ABB2BF">].</span><span style="color: #61AFEF">includes</span><span style="color: #ABB2BF">(</span><span style="color: #D19A66">NaN</span><span style="color: #ABB2BF">)</span></span>
<span class=line><span style="color: #7F848E; font-style: italic">// true</span></span></code></pre>
</code></pre><p>最后这个方法有一个可选的 <code>fromIndex</code> 第二参数，来判断是否在该位置：</p><pre><code class=language-js><pre class=shiki style="background-color: #282c34"><code><span class=line><span style="color: #7F848E; font-style: italic">// 数组内位置 1 是否是 &#39;a&#39;</span></span>
<span class=line><span style="color: #ABB2BF">[</span><span style="color: #98C379">&#39;a&#39;</span><span style="color: #ABB2BF">, </span><span style="color: #98C379">&#39;b&#39;</span><span style="color: #ABB2BF">, </span><span style="color: #98C379">&#39;c&#39;</span><span style="color: #ABB2BF">].</span><span style="color: #61AFEF">includes</span><span style="color: #ABB2BF">(</span><span style="color: #98C379">&#39;a&#39;</span><span style="color: #ABB2BF">, </span><span style="color: #D19A66">1</span><span style="color: #ABB2BF">)</span></span>
<span class=line><span style="color: #7F848E; font-style: italic">// false</span></span></code></pre>
</code></pre><h2 id=exponentiation-operator>Exponentiation Operator</h2><p>指数运算在一些 3D，VR，SVG，数据可视化等经常需要使用到，之前我们只能使用Math.pow或者自行创建一些函数或循环来实现，在ES7中我们可以像python等语言一样，使用 <code>**</code> 号来表示指数了。</p><pre><code class=language-js><pre class=shiki style="background-color: #282c34"><code><span class=line><span style="color: #D19A66">7</span><span style="color: #ABB2BF"> </span><span style="color: #56B6C2">**</span><span style="color: #ABB2BF"> </span><span style="color: #D19A66">12</span><span style="color: #ABB2BF"> </span><span style="color: #56B6C2">===</span><span style="color: #ABB2BF"> </span><span style="color: #E5C07B">Math</span><span style="color: #ABB2BF">.</span><span style="color: #56B6C2">pow</span><span style="color: #ABB2BF">(</span><span style="color: #D19A66">7</span><span style="color: #ABB2BF">, </span><span style="color: #D19A66">12</span><span style="color: #ABB2BF">)  </span><span style="color: #7F848E; font-style: italic">// true</span></span>
<span class=line><span style="color: #D19A66">2</span><span style="color: #ABB2BF"> </span><span style="color: #56B6C2">**</span><span style="color: #ABB2BF"> </span><span style="color: #D19A66">7</span><span style="color: #ABB2BF"> </span><span style="color: #56B6C2">===</span><span style="color: #ABB2BF"> </span><span style="color: #E5C07B">Math</span><span style="color: #ABB2BF">.</span><span style="color: #56B6C2">pow</span><span style="color: #ABB2BF">(</span><span style="color: #D19A66">2</span><span style="color: #ABB2BF">, </span><span style="color: #D19A66">7</span><span style="color: #ABB2BF">)  </span><span style="color: #7F848E; font-style: italic">// true</span></span></code></pre>
</code></pre><p>同样的，也可以使用运算赋值符号：</p><pre><code class=language-js><pre class=shiki style="background-color: #282c34"><code><span class=line><span style="color: #C678DD">let</span><span style="color: #ABB2BF"> </span><span style="color: #E06C75">a</span><span style="color: #ABB2BF"> </span><span style="color: #56B6C2">=</span><span style="color: #ABB2BF"> </span><span style="color: #D19A66">8</span></span>
<span class=line><span style="color: #E06C75">a</span><span style="color: #ABB2BF"> </span><span style="color: #56B6C2">**=</span><span style="color: #ABB2BF"> </span><span style="color: #D19A66">12</span></span>
<span class=line></span>
<span class=line><span style="color: #E06C75">a</span><span style="color: #ABB2BF"> </span><span style="color: #56B6C2">===</span><span style="color: #ABB2BF"> </span><span style="color: #E5C07B">Math</span><span style="color: #ABB2BF">.</span><span style="color: #56B6C2">pow</span><span style="color: #ABB2BF">(</span><span style="color: #D19A66">8</span><span style="color: #ABB2BF">, </span><span style="color: #D19A66">12</span><span style="color: #ABB2BF">)</span></span>
<span class=line><span style="color: #7F848E; font-style: italic">// true</span></span></code></pre>
</code></pre><h2 id=objectvalues--objectentries><code>Object.values</code> / <code>Object.entries</code></h2><p><code>Object.keys</code>提供了对象本身的属性键值对合集，而 <code>Object.values</code> 则返回了所有值的合集。</p><pre><code class=language-js><pre class=shiki style="background-color: #282c34"><code><span class=line><span style="color: #C678DD">let</span><span style="color: #ABB2BF"> </span><span style="color: #E06C75">obj</span><span style="color: #ABB2BF"> </span><span style="color: #56B6C2">=</span><span style="color: #ABB2BF"> {</span><span style="color: #E06C75">a</span><span style="color: #ABB2BF">: </span><span style="color: #D19A66">1</span><span style="color: #ABB2BF">, </span><span style="color: #E06C75">b</span><span style="color: #ABB2BF">: </span><span style="color: #D19A66">2</span><span style="color: #ABB2BF">, </span><span style="color: #E06C75">c</span><span style="color: #ABB2BF">: </span><span style="color: #D19A66">3</span><span style="color: #ABB2BF">}</span></span>
<span class=line></span>
<span class=line><span style="color: #E5C07B">Object</span><span style="color: #ABB2BF">.</span><span style="color: #61AFEF">values</span><span style="color: #ABB2BF">(</span><span style="color: #E06C75">obj</span><span style="color: #ABB2BF">)  </span><span style="color: #7F848E; font-style: italic">// [1, 2, 3]</span></span>
<span class=line></span></code></pre>
</code></pre><p><code>Object.entries</code> 则将每一个键值对放入同一个数组内返回。</p><pre><code class=language-js><pre class=shiki style="background-color: #282c34"><code><span class=line><span style="color: #E5C07B">Object</span><span style="color: #ABB2BF">.</span><span style="color: #61AFEF">entries</span><span style="color: #ABB2BF">(</span><span style="color: #E06C75">obj</span><span style="color: #ABB2BF">)  </span><span style="color: #7F848E; font-style: italic">// [[&quot;a&quot;, 1], [&quot;b&quot;, 2], [&quot;c&quot;, 3]]</span></span></code></pre>
</code></pre><p>注意这两者的顺序和 <code>Object.keys</code> 是一样的，按照键名 - 数字按从小到大 - 字符串则按创建顺序 - symbol也按照创建顺序。</p><p>我们可以配合解构赋值来使用这两个方法：</p><pre><code class=language-js><pre class=shiki style="background-color: #282c34"><code><span class=line><span style="color: #C678DD">let</span><span style="color: #ABB2BF"> </span><span style="color: #E06C75">obj</span><span style="color: #ABB2BF"> </span><span style="color: #56B6C2">=</span><span style="color: #ABB2BF"> {</span><span style="color: #E06C75">a</span><span style="color: #ABB2BF">: </span><span style="color: #D19A66">1</span><span style="color: #ABB2BF">, </span><span style="color: #E06C75">b</span><span style="color: #ABB2BF">: </span><span style="color: #D19A66">2</span><span style="color: #ABB2BF">, </span><span style="color: #E06C75">c</span><span style="color: #ABB2BF">: </span><span style="color: #D19A66">3</span><span style="color: #ABB2BF">}</span></span>
<span class=line><span style="color: #E5C07B">Object</span><span style="color: #ABB2BF">.</span><span style="color: #61AFEF">entries</span><span style="color: #ABB2BF">(</span><span style="color: #E06C75">obj</span><span style="color: #ABB2BF">).</span><span style="color: #61AFEF">forEach</span><span style="color: #ABB2BF">(([</span><span style="color: #E06C75; font-style: italic">key</span><span style="color: #ABB2BF">, </span><span style="color: #E06C75; font-style: italic">value</span><span style="color: #ABB2BF">]) </span><span style="color: #C678DD">=&gt;</span><span style="color: #ABB2BF"> {</span></span>
<span class=line><span style="color: #ABB2BF"> </span><span style="color: #E5C07B">console</span><span style="color: #ABB2BF">.</span><span style="color: #61AFEF">log</span><span style="color: #ABB2BF">(</span><span style="color: #98C379">`</span><span style="color: #C678DD">${</span><span style="color: #E06C75">key</span><span style="color: #C678DD">}</span><span style="color: #98C379"> is </span><span style="color: #C678DD">${</span><span style="color: #E06C75">value</span><span style="color: #C678DD">}</span><span style="color: #98C379">`</span><span style="color: #ABB2BF">)</span></span>
<span class=line><span style="color: #ABB2BF">})</span></span>
<span class=line><span style="color: #7F848E; font-style: italic">// a is 1, b is 2, c is 3</span></span></code></pre>
</code></pre><p>当然 forEach 也可以用 ES6 的 <code>for of</code> 循环来替代:</p><pre><code class=language-js><pre class=shiki style="background-color: #282c34"><code><span class=line><span style="color: #C678DD">let</span><span style="color: #ABB2BF"> </span><span style="color: #E06C75">obj</span><span style="color: #ABB2BF"> </span><span style="color: #56B6C2">=</span><span style="color: #ABB2BF"> {</span><span style="color: #E06C75">a</span><span style="color: #ABB2BF">: </span><span style="color: #D19A66">1</span><span style="color: #ABB2BF">, </span><span style="color: #E06C75">b</span><span style="color: #ABB2BF">: </span><span style="color: #D19A66">2</span><span style="color: #ABB2BF">, </span><span style="color: #E06C75">c</span><span style="color: #ABB2BF">: </span><span style="color: #D19A66">3</span><span style="color: #ABB2BF">}</span></span>
<span class=line><span style="color: #C678DD">for</span><span style="color: #ABB2BF"> (</span><span style="color: #C678DD">let</span><span style="color: #ABB2BF"> [</span><span style="color: #E06C75">key</span><span style="color: #ABB2BF">, </span><span style="color: #E06C75">value</span><span style="color: #ABB2BF">] </span><span style="color: #C678DD">of</span><span style="color: #ABB2BF"> </span><span style="color: #E5C07B">Object</span><span style="color: #ABB2BF">.</span><span style="color: #61AFEF">entries</span><span style="color: #ABB2BF">(</span><span style="color: #E06C75">obj</span><span style="color: #ABB2BF">)) {</span></span>
<span class=line><span style="color: #ABB2BF">  </span><span style="color: #E5C07B">console</span><span style="color: #ABB2BF">.</span><span style="color: #61AFEF">log</span><span style="color: #ABB2BF">(</span><span style="color: #98C379">`</span><span style="color: #C678DD">${</span><span style="color: #E06C75">key</span><span style="color: #C678DD">}</span><span style="color: #98C379"> is </span><span style="color: #C678DD">${</span><span style="color: #E06C75">value</span><span style="color: #C678DD">}</span><span style="color: #98C379">`</span><span style="color: #ABB2BF">)</span></span>
<span class=line><span style="color: #ABB2BF">}</span></span>
<span class=line><span style="color: #7F848E; font-style: italic">// a is 1, b is 2, c is 3</span></span></code></pre>
</code></pre><h2 id=string-padding>String padding</h2><p>我们在css中经常会使用到padding来控制内边距的距离，在js中也可以类似这种概念来理解。</p><p>ES2017 引入字符串补全长度的功能。如果某个字符串不够指定长度，会在头部或尾部补全。</p><p>使用 <code>String.prototype.padStart</code> 和 <code>String.prototype.padEnd</code> 来分别在字符串的开头和末尾插入内容并返回固定长度的字符串。</p><pre><code class=language-js><pre class=shiki style="background-color: #282c34"><code><span class=line><span style="color: #98C379">&#39;react&#39;</span><span style="color: #ABB2BF">.</span><span style="color: #61AFEF">padStart</span><span style="color: #ABB2BF">(</span><span style="color: #D19A66">10</span><span style="color: #ABB2BF">)</span></span>
<span class=line><span style="color: #7F848E; font-style: italic">// return &quot;     react&quot;</span></span>
<span class=line><span style="color: #7F848E; font-style: italic">// 注意前面有5个空格</span></span>
<span class=line></span>
<span class=line><span style="color: #98C379">&#39;react&#39;</span><span style="color: #ABB2BF">.</span><span style="color: #61AFEF">padStart</span><span style="color: #ABB2BF">(</span><span style="color: #D19A66">10</span><span style="color: #ABB2BF">).</span><span style="color: #E06C75">length</span></span>
<span class=line><span style="color: #7F848E; font-style: italic">// 10</span></span></code></pre>
</code></pre><p>在一些牵涉到数字计算的时候我们可以用其返回固定长度的字符串来方便对齐：</p><pre><code class=language-js><pre class=shiki style="background-color: #282c34"><code><span class=line><span style="color: #E5C07B">console</span><span style="color: #ABB2BF">.</span><span style="color: #61AFEF">log</span><span style="color: #ABB2BF">(</span><span style="color: #98C379">&#39;0.00&#39;</span><span style="color: #ABB2BF">.</span><span style="color: #61AFEF">padStart</span><span style="color: #ABB2BF">(</span><span style="color: #D19A66">20</span><span style="color: #ABB2BF">))</span></span>
<span class=line><span style="color: #E5C07B">console</span><span style="color: #ABB2BF">.</span><span style="color: #61AFEF">log</span><span style="color: #ABB2BF">(</span><span style="color: #98C379">&#39;10,000.00&#39;</span><span style="color: #ABB2BF">.</span><span style="color: #61AFEF">padStart</span><span style="color: #ABB2BF">(</span><span style="color: #D19A66">20</span><span style="color: #ABB2BF">))</span></span>
<span class=line><span style="color: #E5C07B">console</span><span style="color: #ABB2BF">.</span><span style="color: #61AFEF">log</span><span style="color: #ABB2BF">(</span><span style="color: #98C379">&#39;250,000.00&#39;</span><span style="color: #ABB2BF">.</span><span style="color: #61AFEF">padStart</span><span style="color: #ABB2BF">(</span><span style="color: #D19A66">20</span><span style="color: #ABB2BF">))</span></span></code></pre>
</code></pre><p>结果将统一长度：</p><pre><code class=language-js><pre class=shiki style="background-color: #282c34"><code><span class=line><span style="color: #ABB2BF">                </span><span style="color: #D19A66">0.00</span></span>
<span class=line><span style="color: #ABB2BF">           </span><span style="color: #D19A66">10</span><span style="color: #ABB2BF">,</span><span style="color: #D19A66">000</span><span style="color: #ABB2BF">.</span><span style="color: #D19A66">00</span></span>
<span class=line><span style="color: #ABB2BF">          </span><span style="color: #D19A66">250</span><span style="color: #ABB2BF">,</span><span style="color: #D19A66">000</span><span style="color: #ABB2BF">.</span><span style="color: #D19A66">00</span></span></code></pre>
</code></pre><p>第二个可选参数用来说明需要插入的内容：</p><pre><code class=language-js><pre class=shiki style="background-color: #282c34"><code><span class=line><span style="color: #E5C07B">console</span><span style="color: #ABB2BF">.</span><span style="color: #61AFEF">log</span><span style="color: #ABB2BF">(</span><span style="color: #98C379">&#39;react&#39;</span><span style="color: #ABB2BF">.</span><span style="color: #61AFEF">padStart</span><span style="color: #ABB2BF">(</span><span style="color: #D19A66">10</span><span style="color: #ABB2BF">, </span><span style="color: #98C379">&#39;_&#39;</span><span style="color: #ABB2BF">))</span></span>
<span class=line><span style="color: #7F848E; font-style: italic">// &quot;_____react&quot;</span></span>
<span class=line></span>
<span class=line><span style="color: #E5C07B">console</span><span style="color: #ABB2BF">.</span><span style="color: #61AFEF">log</span><span style="color: #ABB2BF">(</span><span style="color: #98C379">&#39;backbone&#39;</span><span style="color: #ABB2BF">.</span><span style="color: #61AFEF">padStart</span><span style="color: #ABB2BF">(</span><span style="color: #D19A66">10</span><span style="color: #ABB2BF">, </span><span style="color: #98C379">&#39;*&#39;</span><span style="color: #ABB2BF">))</span></span>
<span class=line><span style="color: #7F848E; font-style: italic">// &quot;**backbone&quot;</span></span></code></pre>
</code></pre><p>第二参数的长度可以随意，但总会按照第一个参数输入的长度来截断：</p><pre><code class=language-js><pre class=shiki style="background-color: #282c34"><code><span class=line><span style="color: #E5C07B">console</span><span style="color: #ABB2BF">.</span><span style="color: #61AFEF">log</span><span style="color: #ABB2BF">(</span><span style="color: #98C379">&#39;react&#39;</span><span style="color: #ABB2BF">.</span><span style="color: #61AFEF">padEnd</span><span style="color: #ABB2BF">(</span><span style="color: #D19A66">10</span><span style="color: #ABB2BF">, </span><span style="color: #98C379">&#39;:-)&#39;</span><span style="color: #ABB2BF">))</span></span>
<span class=line><span style="color: #7F848E; font-style: italic">// &quot;react:-):-&quot; is 10</span></span>
<span class=line></span>
<span class=line><span style="color: #E5C07B">console</span><span style="color: #ABB2BF">.</span><span style="color: #61AFEF">log</span><span style="color: #ABB2BF">(</span><span style="color: #98C379">&#39;backbone&#39;</span><span style="color: #ABB2BF">.</span><span style="color: #61AFEF">padEnd</span><span style="color: #ABB2BF">(</span><span style="color: #D19A66">10</span><span style="color: #ABB2BF">, </span><span style="color: #98C379">&#39;*&#39;</span><span style="color: #ABB2BF">))</span></span>
<span class=line><span style="color: #7F848E; font-style: italic">// &quot;backbone**&quot; is 10</span></span></code></pre>
</code></pre><h2 id=objectgetownpropertydescriptors><code>Object.getOwnPropertyDescriptors</code></h2><p>看名字就知道了，返回所有对象自身属性的属性描述符。相比于 <code>Object.getOwnPropertyDescriptor(obj, propName)</code>, 这个方法将所有的自身属性的描述符均放入数组内返回了。</p><p>这个方法的引入目的，主要是为了解决Object.assign()无法正确拷贝get属性和set属性的问题。</p><p>我们在使用 ES6 的 <code>Object.assign</code> 来浅复制一个对象的时候，它总是拷贝一个属性的值，而不会拷贝它背后的赋值方法或取值方法。</p><p>这时，<code>Object.getOwnPropertyDescriptors</code> 方法配合<code>Object.defineProperties</code> 方法，就可以实现正确拷贝。</p><pre><code class=language-js><pre class=shiki style="background-color: #282c34"><code><span class=line><span style="color: #C678DD">const</span><span style="color: #ABB2BF"> </span><span style="color: #61AFEF">shallowMerge</span><span style="color: #ABB2BF"> </span><span style="color: #56B6C2">=</span><span style="color: #ABB2BF"> (</span><span style="color: #E06C75; font-style: italic">target</span><span style="color: #ABB2BF">, </span><span style="color: #E06C75; font-style: italic">source</span><span style="color: #ABB2BF">) </span><span style="color: #C678DD">=&gt;</span><span style="color: #ABB2BF"> </span><span style="color: #E5C07B">Object</span><span style="color: #ABB2BF">.</span><span style="color: #61AFEF">defineProperties</span><span style="color: #ABB2BF">(</span></span>
<span class=line><span style="color: #ABB2BF">  </span><span style="color: #E06C75">target</span><span style="color: #ABB2BF">,</span></span>
<span class=line><span style="color: #ABB2BF">  </span><span style="color: #E5C07B">Object</span><span style="color: #ABB2BF">.</span><span style="color: #61AFEF">getOwnPropertyDescriptors</span><span style="color: #ABB2BF">(</span><span style="color: #E06C75">source</span><span style="color: #ABB2BF">)</span></span>
<span class=line><span style="color: #ABB2BF">);</span></span></code></pre>
</code></pre><p>另一个用法，是配合Object.create方法，将对象属性克隆到一个新对象。这也属于浅拷贝。</p><pre><code class=language-js><pre class=shiki style="background-color: #282c34"><code><span class=line><span style="color: #C678DD">const</span><span style="color: #ABB2BF"> </span><span style="color: #61AFEF">shallowClone</span><span style="color: #ABB2BF"> </span><span style="color: #56B6C2">=</span><span style="color: #ABB2BF"> </span><span style="color: #E06C75; font-style: italic">obj</span><span style="color: #ABB2BF"> </span><span style="color: #C678DD">=&gt;</span><span style="color: #ABB2BF"> </span><span style="color: #E5C07B">Object</span><span style="color: #ABB2BF">.</span><span style="color: #61AFEF">create</span><span style="color: #ABB2BF">(</span></span>
<span class=line><span style="color: #ABB2BF">  </span><span style="color: #E5C07B">Object</span><span style="color: #ABB2BF">.</span><span style="color: #61AFEF">getPrototypeOf</span><span style="color: #ABB2BF">(</span><span style="color: #E06C75">obj</span><span style="color: #ABB2BF">),</span></span>
<span class=line><span style="color: #ABB2BF">  </span><span style="color: #E5C07B">Object</span><span style="color: #ABB2BF">.</span><span style="color: #61AFEF">getOwnPropertyDescriptors</span><span style="color: #ABB2BF">(</span><span style="color: #E06C75">obj</span><span style="color: #ABB2BF">)</span></span>
<span class=line><span style="color: #ABB2BF">)</span></span></code></pre>
</code></pre><p>更多的用法可以参考 <a href="http://es6.ruanyifeng.com/?search=assign&amp;x=0&amp;y=0#docs/object#Object-assign">http://es6.ruanyifeng.com/?search=assign&amp;x=0&amp;y=0#docs/object#Object-assign</a></p><h2 id=trailing-commas-in-function-parameter-lists-and-calls>Trailing commas in function parameter lists and calls</h2><p>我们在使用数组和对象的时候，最后一个值的末尾都可以加逗号，而在函数的参数中是不行的。</p><pre><code class=language-js><pre class=shiki style="background-color: #282c34"><code><span class=line><span style="color: #C678DD">const</span><span style="color: #ABB2BF"> </span><span style="color: #E5C07B">a</span><span style="color: #ABB2BF"> </span><span style="color: #56B6C2">=</span><span style="color: #ABB2BF"> [</span><span style="color: #D19A66">1</span><span style="color: #ABB2BF">, </span><span style="color: #D19A66">2</span><span style="color: #ABB2BF">, </span><span style="color: #D19A66">3</span><span style="color: #ABB2BF">,]</span></span>
<span class=line><span style="color: #7F848E; font-style: italic">// ok!</span></span>
<span class=line></span>
<span class=line><span style="color: #C678DD">const</span><span style="color: #ABB2BF"> </span><span style="color: #E5C07B">b</span><span style="color: #ABB2BF"> </span><span style="color: #56B6C2">=</span><span style="color: #ABB2BF"> {</span><span style="color: #E06C75">name</span><span style="color: #ABB2BF">: </span><span style="color: #98C379">&#39;xxx&#39;</span><span style="color: #ABB2BF">, </span><span style="color: #E06C75">age</span><span style="color: #ABB2BF">: </span><span style="color: #D19A66">18</span><span style="color: #ABB2BF">,}</span></span>
<span class=line><span style="color: #7F848E; font-style: italic">// ok!</span></span>
<span class=line></span>
<span class=line><span style="color: #C678DD">const</span><span style="color: #ABB2BF"> </span><span style="color: #61AFEF">c</span><span style="color: #ABB2BF"> </span><span style="color: #56B6C2">=</span><span style="color: #ABB2BF"> </span><span style="color: #C678DD">function</span><span style="color: #ABB2BF">(</span><span style="color: #E06C75; font-style: italic">a</span><span style="color: #ABB2BF">, </span><span style="color: #E06C75; font-style: italic">b</span><span style="color: #ABB2BF">, </span><span style="color: #E06C75; font-style: italic">c</span><span style="color: #ABB2BF">,) {</span></span>
<span class=line><span style="color: #ABB2BF">  </span><span style="color: #7F848E; font-style: italic">// some code</span></span>
<span class=line><span style="color: #ABB2BF">}</span></span>
<span class=line><span style="color: #7F848E; font-style: italic">// Uncaught SyntaxError: Unexpected token (</span></span></code></pre>
</code></pre><p>而这一特性引入后，这种写法也不会再报错了。</p><h2 id=async-functions>Async functions</h2><p>async/await 是什么？一句话，它就是 Generator 函数的语法糖。限于篇幅，这篇文章就不细说了，之后再写一篇文章详细记录。</p><p>具体的内容可以参见<a href="http://es6.ruanyifeng.com/?search=assign&amp;x=0&amp;y=0#docs/async">http://es6.ruanyifeng.com/?search=assign&amp;x=0&amp;y=0#docs/async</a>。</p><h2 id=shared-memory-and-atomics>Shared memory and atomics</h2><p>共享内存允许多个线程并发读写数据，而原子操作则能够进行并发控制，确保多个存在竞争关系的线程顺序执行。关于这一点因为自己目前了解的还不多，这里就就不详细说明了，更多的内容可以参见这个<a href=https://github.com/tc39/ecmascript_sharedmem/blob/master/TUTORIAL.md>简介的文档</a>和<a href=https://github.com/tc39/ecmascript_sharedmem>详细的规范</a>。</p><h2 id=lifting-template-literal-restriction>Lifting template literal restriction</h2><p>这一特性因为要到2018年才发布，因此准确来说应该算是 ES2018(ES9) 的特性。</p><p>模版字符串中关于转义字符遵循下面的规则：</p><ul><li>Unicode escapes started by &quot;\u&quot;, for example \u00A9</li><li>Unicode code point escapes indicated by &quot;\u{}&quot;, for example \u{2F804}</li><li>Hexadecimal escapes started by &quot;\x&quot;, for example \xA9</li><li>Octal literal escapes started by &quot;&quot; and (a) digit(s), for example \251</li></ul><p>因此有的时候带标签的模版字符串使用时会造成错误，比如：</p><p>注： 带标签的模版字符串其实是函数调用的一种特殊形式。“标签”指的就是函数，紧跟在后面的模板字符串就是它的参数。</p><pre><code class=language-js><pre class=shiki style="background-color: #282c34"><code><span class=line><span style="color: #61AFEF">latex</span><span style="color: #98C379">`</span><span style="color: #56B6C2">\u</span><span style="color: #98C379">nicode`</span></span>
<span class=line><span style="color: #7F848E; font-style: italic">// Throws in older ECMAScript versions (ES2016 and earlier)</span></span>
<span class=line><span style="color: #7F848E; font-style: italic">// SyntaxError: Invalid Unicode escape sequence</span></span></code></pre>
</code></pre><p>ES9 的这一特性则移除了这一限制。</p><h4 id=ref>ref</h4><ul><li><p><a href=http://es6.ruanyifeng.com/ >http://es6.ruanyifeng.com/</a></p></li><li><p><a href=https://node.university/blog/498412/es7-es8>https://node.university/blog/498412/es7-es8</a></p></li><li><p><a href=https://github.com/tc39/proposals/blob/master/finished-proposals.md>https://github.com/tc39/proposals/blob/master/finished-proposals.md</a></p></li><li><p><a href=https://tc39.github.io/proposal-template-literal-revision/ >https://tc39.github.io/proposal-template-literal-revision/</a></p></li></ul></div><div class=footer><hr><div class=footer-link><a href=/archive><i class="fa fa-archive" aria-hidden=true></i></a><a target=_blank href=https://twitter.com/chow_won><i class="fa fa-twitter" aria-hidden=true></i></a> <a target=_blank href=https://github.com/zoubingwu><i class="fa fa-github" aria-hidden=true></i></a> <a target=_blank href=mailto:zoubingwu@gmail.com><i class="fa fa-envelope" aria-hidden=true></i></a></div>© 2016-2023 zoubingwu. All rights reserved.</div></div></body></html>