<!DOCTYPE html><html lang=en><head><meta charset=utf-8><meta name=viewport content="width=device-width,initial-scale=1,maximum-scale=1,minimum-scale=1,user-scalable=no"><meta name=keywords content=blog,html,css,javascript,react,vue,nodejs><meta name=description content="zoubingwu 个人博客, zoubingwu's blog"><link href=/assets/images/favicon.ico rel=bookmark type=image/x-icon><link href=/assets/images/favicon.ico rel=icon type=image/x-icon><link href=/assets/images/favicon.ico rel="shortcut icon" type=image/x-icon><link rel=stylesheet href=/assets/css/main.css type=text/css><link rel=preload href=/assets/fonts/googlefont.css as=style><link rel=preload href=https://cdn.bootcdn.net/ajax/libs/font-awesome/4.7.0/css/font-awesome.min.css as=style><link rel=stylesheet href=/assets/fonts/googlefont.css as=style><link rel=stylesheet href=https://cdn.bootcdn.net/ajax/libs/font-awesome/4.7.0/css/font-awesome.min.css as=style><link rel=alternate type=application/rss+xml title="RSS Feed for zoubingwu's blog" href=/feed.xml><title>Understanding transducer in Javascript | https://zoubingwu.com</title><meta property=og:title content="Understanding transducer in Javascript | https://zoubingwu.com"><meta property=og:locale content=en_US><meta name=description content="How do transducers work underneath the hood? This article explores transducers using JavaScript code examples."><meta property=og:description content="How do transducers work underneath the hood? This article explores transducers using JavaScript code examples."><link rel=canonical href=https://zoubingwu.com/2018-08-06/understanding-transducer-in-javascript><meta property=og:url content=https://zoubingwu.com/2018-08-06/understanding-transducer-in-javascript><meta property=og:site_name content="zoubingwu's blog"><meta property=og:type content=article><meta property=article:published_time content=2018-08-06T16:53:31.000Z><meta name=twitter:card content=summary><meta property=twitter:title content="Understanding transducer in Javascript | https://zoubingwu.com"><script>(function (i, s, o, g, r, a, m) { i['GoogleAnalyticsObject'] = r; (i[r] = i[r]
  || function () { (i[r].q = i[r].q || []).push(arguments); }), (i[r].l = 1 *
  new Date()); (a = s.createElement(o)), (m = s.getElementsByTagName(o)[0]);
  a.async = 1; a.src = g; m.parentNode.insertBefore(a, m); })( window, document,
  'script', 'https://www.google-analytics.com/analytics.js', 'ga' );
  ga('create', 'UA-100363260-1', 'auto'); ga('send', 'pageview');</script></head><body><div class=content-container><div class=post><div class=post-title>Understanding transducer in Javascript</div><span class=post-date><time>6 Aug 2018</time></span><div class=post-tag><ul><li><a><span><i class="fa fa-paperclip" aria-hidden=true></i>javascript</span></a></li><li><a><span><i class="fa fa-paperclip" aria-hidden=true></i>functional programming</span></a></li><li><a><span><i class="fa fa-paperclip" aria-hidden=true></i>transducers</span></a></li></ul></div><h2 id=what-are-transducers>What are transducers?</h2><p>Transducer 是 transform 和 reducer 两个词的结合，熟悉 JavaScript 的同学都很了解 Array 的 reduce 方法了，我们有时候会需要遍历一个数组，将其变换结构后再 reduce 成最后需要的结果。</p><p>而 transducer 简单来说就是一种可组合的、不用生成中间变量的高效方式来达到上面的结果。</p><p>相比下面这样每一次的调用都会遍历后生成一个新的中间数组：</p><pre><code class=language-js><div class=shiki-light><pre class=shiki style="background-color: #ffffff"><code><span class=line><span style="color: #24292E">array.</span><span style="color: #6F42C1">map</span><span style="color: #24292E">(fn1).</span><span style="color: #6F42C1">filter</span><span style="color: #24292E">(fn2).</span><span style="color: #6F42C1">reduce</span><span style="color: #24292E">(fn3);</span></span>
<span class=line></span>
<span class=line><span style="color: #6A737D">// array1 =&gt; array2 =&gt; result</span></span></code></pre></div><div class=shiki-dark><pre class=shiki style="background-color: #0d1117"><code><span class=line><span style="color: #C9D1D9">array.</span><span style="color: #D2A8FF">map</span><span style="color: #C9D1D9">(fn1).</span><span style="color: #D2A8FF">filter</span><span style="color: #C9D1D9">(fn2).</span><span style="color: #D2A8FF">reduce</span><span style="color: #C9D1D9">(fn3);</span></span>
<span class=line></span>
<span class=line><span style="color: #8B949E">// array1 =&gt; array2 =&gt; result</span></span></code></pre></div>
</code></pre><p>我们更希望的是省略中间的过渡结果，而直接得到最后的结果：</p><pre><code class=language-js><div class=shiki-light><pre class=shiki style="background-color: #ffffff"><code><span class=line><span style="color: #D73A49">const</span><span style="color: #24292E"> </span><span style="color: #005CC5">transformation</span><span style="color: #24292E"> </span><span style="color: #D73A49">=</span><span style="color: #24292E"> </span><span style="color: #6F42C1">compose</span><span style="color: #24292E">(</span><span style="color: #6F42C1">map</span><span style="color: #24292E">(fn1), </span><span style="color: #6F42C1">filter</span><span style="color: #24292E">(fn2), </span><span style="color: #6F42C1">reduce</span><span style="color: #24292E">(fn3));</span></span>
<span class=line></span>
<span class=line><span style="color: #6F42C1">transformation</span><span style="color: #24292E">(array);</span></span>
<span class=line><span style="color: #6A737D">//array1 =&gt; result</span></span></code></pre></div><div class=shiki-dark><pre class=shiki style="background-color: #0d1117"><code><span class=line><span style="color: #FF7B72">const</span><span style="color: #C9D1D9"> </span><span style="color: #79C0FF">transformation</span><span style="color: #C9D1D9"> </span><span style="color: #FF7B72">=</span><span style="color: #C9D1D9"> </span><span style="color: #D2A8FF">compose</span><span style="color: #C9D1D9">(</span><span style="color: #D2A8FF">map</span><span style="color: #C9D1D9">(fn1), </span><span style="color: #D2A8FF">filter</span><span style="color: #C9D1D9">(fn2), </span><span style="color: #D2A8FF">reduce</span><span style="color: #C9D1D9">(fn3));</span></span>
<span class=line></span>
<span class=line><span style="color: #D2A8FF">transformation</span><span style="color: #C9D1D9">(array);</span></span>
<span class=line><span style="color: #8B949E">//array1 =&gt; result</span></span></code></pre></div>
</code></pre><p>同时我们也可以在其他地方复用这个 transformation，或者将其与其他的方法组合。</p><h2 id=power-of-reduce>Power of reduce</h2><p>通常会组合 map 和 filter：</p><pre><code class=language-js><div class=shiki-light><pre class=shiki style="background-color: #ffffff"><code><span class=line><span style="color: #24292E">[</span><span style="color: #005CC5">0</span><span style="color: #24292E">, </span><span style="color: #005CC5">1</span><span style="color: #24292E">, </span><span style="color: #005CC5">2</span><span style="color: #24292E">, </span><span style="color: #005CC5">3</span><span style="color: #24292E">, </span><span style="color: #005CC5">4</span><span style="color: #24292E">, </span><span style="color: #005CC5">5</span><span style="color: #24292E">, </span><span style="color: #005CC5">6</span><span style="color: #24292E">, </span><span style="color: #005CC5">7</span><span style="color: #24292E">, </span><span style="color: #005CC5">8</span><span style="color: #24292E">, </span><span style="color: #005CC5">9</span><span style="color: #24292E">].</span><span style="color: #6F42C1">map</span><span style="color: #24292E">((</span><span style="color: #E36209">x</span><span style="color: #24292E">) </span><span style="color: #D73A49">=&gt;</span><span style="color: #24292E"> x </span><span style="color: #D73A49">+</span><span style="color: #24292E"> </span><span style="color: #005CC5">1</span><span style="color: #24292E">);</span></span>
<span class=line><span style="color: #6A737D">// [1, 2, 3, 4, 5, 6, 7, 8, 9, 10]</span></span>
<span class=line></span>
<span class=line><span style="color: #24292E">[</span><span style="color: #005CC5">1</span><span style="color: #24292E">, </span><span style="color: #005CC5">2</span><span style="color: #24292E">, </span><span style="color: #005CC5">3</span><span style="color: #24292E">, </span><span style="color: #005CC5">4</span><span style="color: #24292E">, </span><span style="color: #005CC5">5</span><span style="color: #24292E">, </span><span style="color: #005CC5">6</span><span style="color: #24292E">, </span><span style="color: #005CC5">7</span><span style="color: #24292E">, </span><span style="color: #005CC5">8</span><span style="color: #24292E">, </span><span style="color: #005CC5">9</span><span style="color: #24292E">, </span><span style="color: #005CC5">10</span><span style="color: #24292E">].</span><span style="color: #6F42C1">filter</span><span style="color: #24292E">((</span><span style="color: #E36209">x</span><span style="color: #24292E">) </span><span style="color: #D73A49">=&gt;</span><span style="color: #24292E"> x </span><span style="color: #D73A49">%</span><span style="color: #24292E"> </span><span style="color: #005CC5">2</span><span style="color: #24292E"> </span><span style="color: #D73A49">===</span><span style="color: #24292E"> </span><span style="color: #005CC5">0</span><span style="color: #24292E">);</span></span>
<span class=line><span style="color: #6A737D">// [2, 4, 6, 8, 10]</span></span>
<span class=line></span>
<span class=line><span style="color: #24292E">[</span><span style="color: #005CC5">0</span><span style="color: #24292E">, </span><span style="color: #005CC5">1</span><span style="color: #24292E">, </span><span style="color: #005CC5">2</span><span style="color: #24292E">, </span><span style="color: #005CC5">3</span><span style="color: #24292E">, </span><span style="color: #005CC5">4</span><span style="color: #24292E">, </span><span style="color: #005CC5">5</span><span style="color: #24292E">, </span><span style="color: #005CC5">6</span><span style="color: #24292E">, </span><span style="color: #005CC5">7</span><span style="color: #24292E">, </span><span style="color: #005CC5">8</span><span style="color: #24292E">, </span><span style="color: #005CC5">9</span><span style="color: #24292E">]</span></span>
<span class=line><span style="color: #24292E">  .</span><span style="color: #6F42C1">map</span><span style="color: #24292E">((</span><span style="color: #E36209">x</span><span style="color: #24292E">) </span><span style="color: #D73A49">=&gt;</span><span style="color: #24292E"> x </span><span style="color: #D73A49">+</span><span style="color: #24292E"> </span><span style="color: #005CC5">1</span><span style="color: #24292E">)</span></span>
<span class=line><span style="color: #24292E">  .</span><span style="color: #6F42C1">filter</span><span style="color: #24292E">((</span><span style="color: #E36209">x</span><span style="color: #24292E">) </span><span style="color: #D73A49">=&gt;</span><span style="color: #24292E"> x </span><span style="color: #D73A49">%</span><span style="color: #24292E"> </span><span style="color: #005CC5">2</span><span style="color: #24292E"> </span><span style="color: #D73A49">===</span><span style="color: #24292E"> </span><span style="color: #005CC5">0</span><span style="color: #24292E">);</span></span>
<span class=line><span style="color: #6A737D">// [2, 4, 6, 8, 10]</span></span></code></pre></div><div class=shiki-dark><pre class=shiki style="background-color: #0d1117"><code><span class=line><span style="color: #C9D1D9">[</span><span style="color: #79C0FF">0</span><span style="color: #C9D1D9">, </span><span style="color: #79C0FF">1</span><span style="color: #C9D1D9">, </span><span style="color: #79C0FF">2</span><span style="color: #C9D1D9">, </span><span style="color: #79C0FF">3</span><span style="color: #C9D1D9">, </span><span style="color: #79C0FF">4</span><span style="color: #C9D1D9">, </span><span style="color: #79C0FF">5</span><span style="color: #C9D1D9">, </span><span style="color: #79C0FF">6</span><span style="color: #C9D1D9">, </span><span style="color: #79C0FF">7</span><span style="color: #C9D1D9">, </span><span style="color: #79C0FF">8</span><span style="color: #C9D1D9">, </span><span style="color: #79C0FF">9</span><span style="color: #C9D1D9">].</span><span style="color: #D2A8FF">map</span><span style="color: #C9D1D9">((</span><span style="color: #FFA657">x</span><span style="color: #C9D1D9">) </span><span style="color: #FF7B72">=&gt;</span><span style="color: #C9D1D9"> x </span><span style="color: #FF7B72">+</span><span style="color: #C9D1D9"> </span><span style="color: #79C0FF">1</span><span style="color: #C9D1D9">);</span></span>
<span class=line><span style="color: #8B949E">// [1, 2, 3, 4, 5, 6, 7, 8, 9, 10]</span></span>
<span class=line></span>
<span class=line><span style="color: #C9D1D9">[</span><span style="color: #79C0FF">1</span><span style="color: #C9D1D9">, </span><span style="color: #79C0FF">2</span><span style="color: #C9D1D9">, </span><span style="color: #79C0FF">3</span><span style="color: #C9D1D9">, </span><span style="color: #79C0FF">4</span><span style="color: #C9D1D9">, </span><span style="color: #79C0FF">5</span><span style="color: #C9D1D9">, </span><span style="color: #79C0FF">6</span><span style="color: #C9D1D9">, </span><span style="color: #79C0FF">7</span><span style="color: #C9D1D9">, </span><span style="color: #79C0FF">8</span><span style="color: #C9D1D9">, </span><span style="color: #79C0FF">9</span><span style="color: #C9D1D9">, </span><span style="color: #79C0FF">10</span><span style="color: #C9D1D9">].</span><span style="color: #D2A8FF">filter</span><span style="color: #C9D1D9">((</span><span style="color: #FFA657">x</span><span style="color: #C9D1D9">) </span><span style="color: #FF7B72">=&gt;</span><span style="color: #C9D1D9"> x </span><span style="color: #FF7B72">%</span><span style="color: #C9D1D9"> </span><span style="color: #79C0FF">2</span><span style="color: #C9D1D9"> </span><span style="color: #FF7B72">===</span><span style="color: #C9D1D9"> </span><span style="color: #79C0FF">0</span><span style="color: #C9D1D9">);</span></span>
<span class=line><span style="color: #8B949E">// [2, 4, 6, 8, 10]</span></span>
<span class=line></span>
<span class=line><span style="color: #C9D1D9">[</span><span style="color: #79C0FF">0</span><span style="color: #C9D1D9">, </span><span style="color: #79C0FF">1</span><span style="color: #C9D1D9">, </span><span style="color: #79C0FF">2</span><span style="color: #C9D1D9">, </span><span style="color: #79C0FF">3</span><span style="color: #C9D1D9">, </span><span style="color: #79C0FF">4</span><span style="color: #C9D1D9">, </span><span style="color: #79C0FF">5</span><span style="color: #C9D1D9">, </span><span style="color: #79C0FF">6</span><span style="color: #C9D1D9">, </span><span style="color: #79C0FF">7</span><span style="color: #C9D1D9">, </span><span style="color: #79C0FF">8</span><span style="color: #C9D1D9">, </span><span style="color: #79C0FF">9</span><span style="color: #C9D1D9">]</span></span>
<span class=line><span style="color: #C9D1D9">  .</span><span style="color: #D2A8FF">map</span><span style="color: #C9D1D9">((</span><span style="color: #FFA657">x</span><span style="color: #C9D1D9">) </span><span style="color: #FF7B72">=&gt;</span><span style="color: #C9D1D9"> x </span><span style="color: #FF7B72">+</span><span style="color: #C9D1D9"> </span><span style="color: #79C0FF">1</span><span style="color: #C9D1D9">)</span></span>
<span class=line><span style="color: #C9D1D9">  .</span><span style="color: #D2A8FF">filter</span><span style="color: #C9D1D9">((</span><span style="color: #FFA657">x</span><span style="color: #C9D1D9">) </span><span style="color: #FF7B72">=&gt;</span><span style="color: #C9D1D9"> x </span><span style="color: #FF7B72">%</span><span style="color: #C9D1D9"> </span><span style="color: #79C0FF">2</span><span style="color: #C9D1D9"> </span><span style="color: #FF7B72">===</span><span style="color: #C9D1D9"> </span><span style="color: #79C0FF">0</span><span style="color: #C9D1D9">);</span></span>
<span class=line><span style="color: #8B949E">// [2, 4, 6, 8, 10]</span></span></code></pre></div>
</code></pre><p>但其实这两者都可以用 reduce 来实现：</p><pre><code class=language-js><div class=shiki-light><pre class=shiki style="background-color: #ffffff"><code><span class=line><span style="color: #D73A49">const</span><span style="color: #24292E"> </span><span style="color: #6F42C1">mapIncReducer</span><span style="color: #24292E"> </span><span style="color: #D73A49">=</span><span style="color: #24292E"> (</span><span style="color: #E36209">result</span><span style="color: #24292E">, </span><span style="color: #E36209">input</span><span style="color: #24292E">) </span><span style="color: #D73A49">=&gt;</span><span style="color: #24292E"> {</span></span>
<span class=line><span style="color: #24292E">  result.</span><span style="color: #6F42C1">push</span><span style="color: #24292E">(input </span><span style="color: #D73A49">+</span><span style="color: #24292E"> </span><span style="color: #005CC5">1</span><span style="color: #24292E">);</span></span>
<span class=line><span style="color: #24292E">  </span><span style="color: #D73A49">return</span><span style="color: #24292E"> result;</span></span>
<span class=line><span style="color: #24292E">};</span></span>
<span class=line></span>
<span class=line><span style="color: #24292E">[</span><span style="color: #005CC5">0</span><span style="color: #24292E">, </span><span style="color: #005CC5">1</span><span style="color: #24292E">, </span><span style="color: #005CC5">2</span><span style="color: #24292E">, </span><span style="color: #005CC5">3</span><span style="color: #24292E">, </span><span style="color: #005CC5">4</span><span style="color: #24292E">, </span><span style="color: #005CC5">5</span><span style="color: #24292E">, </span><span style="color: #005CC5">6</span><span style="color: #24292E">, </span><span style="color: #005CC5">7</span><span style="color: #24292E">, </span><span style="color: #005CC5">8</span><span style="color: #24292E">, </span><span style="color: #005CC5">9</span><span style="color: #24292E">].</span><span style="color: #6F42C1">reduce</span><span style="color: #24292E">(mapIncReducer, []);</span></span>
<span class=line><span style="color: #6A737D">// [1, 2, 3, 4, 5, 6, 7, 8, 9, 10]</span></span></code></pre></div><div class=shiki-dark><pre class=shiki style="background-color: #0d1117"><code><span class=line><span style="color: #FF7B72">const</span><span style="color: #C9D1D9"> </span><span style="color: #D2A8FF">mapIncReducer</span><span style="color: #C9D1D9"> </span><span style="color: #FF7B72">=</span><span style="color: #C9D1D9"> (</span><span style="color: #FFA657">result</span><span style="color: #C9D1D9">, </span><span style="color: #FFA657">input</span><span style="color: #C9D1D9">) </span><span style="color: #FF7B72">=&gt;</span><span style="color: #C9D1D9"> {</span></span>
<span class=line><span style="color: #C9D1D9">  result.</span><span style="color: #D2A8FF">push</span><span style="color: #C9D1D9">(input </span><span style="color: #FF7B72">+</span><span style="color: #C9D1D9"> </span><span style="color: #79C0FF">1</span><span style="color: #C9D1D9">);</span></span>
<span class=line><span style="color: #C9D1D9">  </span><span style="color: #FF7B72">return</span><span style="color: #C9D1D9"> result;</span></span>
<span class=line><span style="color: #C9D1D9">};</span></span>
<span class=line></span>
<span class=line><span style="color: #C9D1D9">[</span><span style="color: #79C0FF">0</span><span style="color: #C9D1D9">, </span><span style="color: #79C0FF">1</span><span style="color: #C9D1D9">, </span><span style="color: #79C0FF">2</span><span style="color: #C9D1D9">, </span><span style="color: #79C0FF">3</span><span style="color: #C9D1D9">, </span><span style="color: #79C0FF">4</span><span style="color: #C9D1D9">, </span><span style="color: #79C0FF">5</span><span style="color: #C9D1D9">, </span><span style="color: #79C0FF">6</span><span style="color: #C9D1D9">, </span><span style="color: #79C0FF">7</span><span style="color: #C9D1D9">, </span><span style="color: #79C0FF">8</span><span style="color: #C9D1D9">, </span><span style="color: #79C0FF">9</span><span style="color: #C9D1D9">].</span><span style="color: #D2A8FF">reduce</span><span style="color: #C9D1D9">(mapIncReducer, []);</span></span>
<span class=line><span style="color: #8B949E">// [1, 2, 3, 4, 5, 6, 7, 8, 9, 10]</span></span></code></pre></div>
</code></pre><p>其实可以把递加的逻辑抽取出来作为参数传入：</p><pre><code class=language-js><div class=shiki-light><pre class=shiki style="background-color: #ffffff"><code><span class=line><span style="color: #D73A49">const</span><span style="color: #24292E"> </span><span style="color: #6F42C1">mapReducer</span><span style="color: #24292E"> </span><span style="color: #D73A49">=</span><span style="color: #24292E"> (</span><span style="color: #E36209">f</span><span style="color: #24292E">) </span><span style="color: #D73A49">=&gt;</span><span style="color: #24292E"> (</span><span style="color: #E36209">result</span><span style="color: #24292E">, </span><span style="color: #E36209">input</span><span style="color: #24292E">) </span><span style="color: #D73A49">=&gt;</span><span style="color: #24292E"> {</span></span>
<span class=line><span style="color: #24292E">  result.</span><span style="color: #6F42C1">push</span><span style="color: #24292E">(</span><span style="color: #6F42C1">f</span><span style="color: #24292E">(input));</span></span>
<span class=line><span style="color: #24292E">  </span><span style="color: #D73A49">return</span><span style="color: #24292E"> result;</span></span>
<span class=line><span style="color: #24292E">};</span></span>
<span class=line></span>
<span class=line><span style="color: #24292E">[</span><span style="color: #005CC5">0</span><span style="color: #24292E">, </span><span style="color: #005CC5">1</span><span style="color: #24292E">, </span><span style="color: #005CC5">2</span><span style="color: #24292E">, </span><span style="color: #005CC5">3</span><span style="color: #24292E">, </span><span style="color: #005CC5">4</span><span style="color: #24292E">, </span><span style="color: #005CC5">5</span><span style="color: #24292E">, </span><span style="color: #005CC5">6</span><span style="color: #24292E">, </span><span style="color: #005CC5">7</span><span style="color: #24292E">, </span><span style="color: #005CC5">8</span><span style="color: #24292E">, </span><span style="color: #005CC5">9</span><span style="color: #24292E">].</span><span style="color: #6F42C1">reduce</span><span style="color: #24292E">(</span><span style="color: #6F42C1">mapReducer</span><span style="color: #24292E">((</span><span style="color: #E36209">x</span><span style="color: #24292E">) </span><span style="color: #D73A49">=&gt;</span><span style="color: #24292E"> x </span><span style="color: #D73A49">+</span><span style="color: #24292E"> </span><span style="color: #005CC5">1</span><span style="color: #24292E">), []);</span></span>
<span class=line><span style="color: #6A737D">// [1, 2, 3, 4, 5, 6, 7, 8, 9, 10]</span></span></code></pre></div><div class=shiki-dark><pre class=shiki style="background-color: #0d1117"><code><span class=line><span style="color: #FF7B72">const</span><span style="color: #C9D1D9"> </span><span style="color: #D2A8FF">mapReducer</span><span style="color: #C9D1D9"> </span><span style="color: #FF7B72">=</span><span style="color: #C9D1D9"> (</span><span style="color: #FFA657">f</span><span style="color: #C9D1D9">) </span><span style="color: #FF7B72">=&gt;</span><span style="color: #C9D1D9"> (</span><span style="color: #FFA657">result</span><span style="color: #C9D1D9">, </span><span style="color: #FFA657">input</span><span style="color: #C9D1D9">) </span><span style="color: #FF7B72">=&gt;</span><span style="color: #C9D1D9"> {</span></span>
<span class=line><span style="color: #C9D1D9">  result.</span><span style="color: #D2A8FF">push</span><span style="color: #C9D1D9">(</span><span style="color: #D2A8FF">f</span><span style="color: #C9D1D9">(input));</span></span>
<span class=line><span style="color: #C9D1D9">  </span><span style="color: #FF7B72">return</span><span style="color: #C9D1D9"> result;</span></span>
<span class=line><span style="color: #C9D1D9">};</span></span>
<span class=line></span>
<span class=line><span style="color: #C9D1D9">[</span><span style="color: #79C0FF">0</span><span style="color: #C9D1D9">, </span><span style="color: #79C0FF">1</span><span style="color: #C9D1D9">, </span><span style="color: #79C0FF">2</span><span style="color: #C9D1D9">, </span><span style="color: #79C0FF">3</span><span style="color: #C9D1D9">, </span><span style="color: #79C0FF">4</span><span style="color: #C9D1D9">, </span><span style="color: #79C0FF">5</span><span style="color: #C9D1D9">, </span><span style="color: #79C0FF">6</span><span style="color: #C9D1D9">, </span><span style="color: #79C0FF">7</span><span style="color: #C9D1D9">, </span><span style="color: #79C0FF">8</span><span style="color: #C9D1D9">, </span><span style="color: #79C0FF">9</span><span style="color: #C9D1D9">].</span><span style="color: #D2A8FF">reduce</span><span style="color: #C9D1D9">(</span><span style="color: #D2A8FF">mapReducer</span><span style="color: #C9D1D9">((</span><span style="color: #FFA657">x</span><span style="color: #C9D1D9">) </span><span style="color: #FF7B72">=&gt;</span><span style="color: #C9D1D9"> x </span><span style="color: #FF7B72">+</span><span style="color: #C9D1D9"> </span><span style="color: #79C0FF">1</span><span style="color: #C9D1D9">), []);</span></span>
<span class=line><span style="color: #8B949E">// [1, 2, 3, 4, 5, 6, 7, 8, 9, 10]</span></span></code></pre></div>
</code></pre><p>这样可以随意的传入各种各样的逻辑：</p><pre><code class=language-js><div class=shiki-light><pre class=shiki style="background-color: #ffffff"><code><span class=line><span style="color: #24292E">[</span><span style="color: #005CC5">0</span><span style="color: #24292E">, </span><span style="color: #005CC5">1</span><span style="color: #24292E">, </span><span style="color: #005CC5">2</span><span style="color: #24292E">, </span><span style="color: #005CC5">3</span><span style="color: #24292E">, </span><span style="color: #005CC5">4</span><span style="color: #24292E">, </span><span style="color: #005CC5">5</span><span style="color: #24292E">, </span><span style="color: #005CC5">6</span><span style="color: #24292E">, </span><span style="color: #005CC5">7</span><span style="color: #24292E">, </span><span style="color: #005CC5">8</span><span style="color: #24292E">, </span><span style="color: #005CC5">9</span><span style="color: #24292E">].</span><span style="color: #6F42C1">reduce</span><span style="color: #24292E">(</span><span style="color: #6F42C1">mapReducer</span><span style="color: #24292E">((</span><span style="color: #E36209">x</span><span style="color: #24292E">) </span><span style="color: #D73A49">=&gt;</span><span style="color: #24292E"> x </span><span style="color: #D73A49">-</span><span style="color: #24292E"> </span><span style="color: #005CC5">1</span><span style="color: #24292E">), []);</span></span>
<span class=line><span style="color: #6A737D">// [-1, 0, 1, 2, 3, 4, 5, 6, 7, 8]</span></span>
<span class=line></span>
<span class=line><span style="color: #24292E">[</span><span style="color: #005CC5">0</span><span style="color: #24292E">, </span><span style="color: #005CC5">1</span><span style="color: #24292E">, </span><span style="color: #005CC5">2</span><span style="color: #24292E">, </span><span style="color: #005CC5">3</span><span style="color: #24292E">, </span><span style="color: #005CC5">4</span><span style="color: #24292E">, </span><span style="color: #005CC5">5</span><span style="color: #24292E">, </span><span style="color: #005CC5">6</span><span style="color: #24292E">, </span><span style="color: #005CC5">7</span><span style="color: #24292E">, </span><span style="color: #005CC5">8</span><span style="color: #24292E">, </span><span style="color: #005CC5">9</span><span style="color: #24292E">].</span><span style="color: #6F42C1">reduce</span><span style="color: #24292E">(</span><span style="color: #6F42C1">mapReducer</span><span style="color: #24292E">((</span><span style="color: #E36209">x</span><span style="color: #24292E">) </span><span style="color: #D73A49">=&gt;</span><span style="color: #24292E"> x </span><span style="color: #D73A49">*</span><span style="color: #24292E"> x), []);</span></span>
<span class=line><span style="color: #6A737D">// [0, 1, 4, 9, 16, 25, 36, 49, 64, 81]</span></span></code></pre></div><div class=shiki-dark><pre class=shiki style="background-color: #0d1117"><code><span class=line><span style="color: #C9D1D9">[</span><span style="color: #79C0FF">0</span><span style="color: #C9D1D9">, </span><span style="color: #79C0FF">1</span><span style="color: #C9D1D9">, </span><span style="color: #79C0FF">2</span><span style="color: #C9D1D9">, </span><span style="color: #79C0FF">3</span><span style="color: #C9D1D9">, </span><span style="color: #79C0FF">4</span><span style="color: #C9D1D9">, </span><span style="color: #79C0FF">5</span><span style="color: #C9D1D9">, </span><span style="color: #79C0FF">6</span><span style="color: #C9D1D9">, </span><span style="color: #79C0FF">7</span><span style="color: #C9D1D9">, </span><span style="color: #79C0FF">8</span><span style="color: #C9D1D9">, </span><span style="color: #79C0FF">9</span><span style="color: #C9D1D9">].</span><span style="color: #D2A8FF">reduce</span><span style="color: #C9D1D9">(</span><span style="color: #D2A8FF">mapReducer</span><span style="color: #C9D1D9">((</span><span style="color: #FFA657">x</span><span style="color: #C9D1D9">) </span><span style="color: #FF7B72">=&gt;</span><span style="color: #C9D1D9"> x </span><span style="color: #FF7B72">-</span><span style="color: #C9D1D9"> </span><span style="color: #79C0FF">1</span><span style="color: #C9D1D9">), []);</span></span>
<span class=line><span style="color: #8B949E">// [-1, 0, 1, 2, 3, 4, 5, 6, 7, 8]</span></span>
<span class=line></span>
<span class=line><span style="color: #C9D1D9">[</span><span style="color: #79C0FF">0</span><span style="color: #C9D1D9">, </span><span style="color: #79C0FF">1</span><span style="color: #C9D1D9">, </span><span style="color: #79C0FF">2</span><span style="color: #C9D1D9">, </span><span style="color: #79C0FF">3</span><span style="color: #C9D1D9">, </span><span style="color: #79C0FF">4</span><span style="color: #C9D1D9">, </span><span style="color: #79C0FF">5</span><span style="color: #C9D1D9">, </span><span style="color: #79C0FF">6</span><span style="color: #C9D1D9">, </span><span style="color: #79C0FF">7</span><span style="color: #C9D1D9">, </span><span style="color: #79C0FF">8</span><span style="color: #C9D1D9">, </span><span style="color: #79C0FF">9</span><span style="color: #C9D1D9">].</span><span style="color: #D2A8FF">reduce</span><span style="color: #C9D1D9">(</span><span style="color: #D2A8FF">mapReducer</span><span style="color: #C9D1D9">((</span><span style="color: #FFA657">x</span><span style="color: #C9D1D9">) </span><span style="color: #FF7B72">=&gt;</span><span style="color: #C9D1D9"> x </span><span style="color: #FF7B72">*</span><span style="color: #C9D1D9"> x), []);</span></span>
<span class=line><span style="color: #8B949E">// [0, 1, 4, 9, 16, 25, 36, 49, 64, 81]</span></span></code></pre></div>
</code></pre><p>同样的 filter 也可以用 reduce 来实现：</p><pre><code class=language-js><div class=shiki-light><pre class=shiki style="background-color: #ffffff"><code><span class=line><span style="color: #D73A49">const</span><span style="color: #24292E"> </span><span style="color: #6F42C1">filterReducer</span><span style="color: #24292E"> </span><span style="color: #D73A49">=</span><span style="color: #24292E"> (</span><span style="color: #E36209">predicate</span><span style="color: #24292E">) </span><span style="color: #D73A49">=&gt;</span><span style="color: #24292E"> (</span><span style="color: #E36209">result</span><span style="color: #24292E">, </span><span style="color: #E36209">input</span><span style="color: #24292E">) </span><span style="color: #D73A49">=&gt;</span><span style="color: #24292E"> {</span></span>
<span class=line><span style="color: #24292E">  </span><span style="color: #D73A49">if</span><span style="color: #24292E"> (</span><span style="color: #6F42C1">predicate</span><span style="color: #24292E">(input)) {</span></span>
<span class=line><span style="color: #24292E">    result.</span><span style="color: #6F42C1">push</span><span style="color: #24292E">(input);</span></span>
<span class=line><span style="color: #24292E">  }</span></span>
<span class=line><span style="color: #24292E">  </span><span style="color: #D73A49">return</span><span style="color: #24292E"> result;</span></span>
<span class=line><span style="color: #24292E">};</span></span>
<span class=line></span>
<span class=line><span style="color: #24292E">[</span><span style="color: #005CC5">1</span><span style="color: #24292E">, </span><span style="color: #005CC5">2</span><span style="color: #24292E">, </span><span style="color: #005CC5">3</span><span style="color: #24292E">, </span><span style="color: #005CC5">4</span><span style="color: #24292E">, </span><span style="color: #005CC5">5</span><span style="color: #24292E">, </span><span style="color: #005CC5">6</span><span style="color: #24292E">, </span><span style="color: #005CC5">7</span><span style="color: #24292E">, </span><span style="color: #005CC5">8</span><span style="color: #24292E">, </span><span style="color: #005CC5">9</span><span style="color: #24292E">, </span><span style="color: #005CC5">10</span><span style="color: #24292E">].</span><span style="color: #6F42C1">reduce</span><span style="color: #24292E">(</span><span style="color: #6F42C1">filterReducer</span><span style="color: #24292E">((</span><span style="color: #E36209">x</span><span style="color: #24292E">) </span><span style="color: #D73A49">=&gt;</span><span style="color: #24292E"> x </span><span style="color: #D73A49">%</span><span style="color: #24292E"> </span><span style="color: #005CC5">2</span><span style="color: #24292E"> </span><span style="color: #D73A49">===</span><span style="color: #24292E"> </span><span style="color: #005CC5">0</span><span style="color: #24292E">), []);</span></span>
<span class=line><span style="color: #6A737D">// [2, 4, 6, 8, 10]</span></span></code></pre></div><div class=shiki-dark><pre class=shiki style="background-color: #0d1117"><code><span class=line><span style="color: #FF7B72">const</span><span style="color: #C9D1D9"> </span><span style="color: #D2A8FF">filterReducer</span><span style="color: #C9D1D9"> </span><span style="color: #FF7B72">=</span><span style="color: #C9D1D9"> (</span><span style="color: #FFA657">predicate</span><span style="color: #C9D1D9">) </span><span style="color: #FF7B72">=&gt;</span><span style="color: #C9D1D9"> (</span><span style="color: #FFA657">result</span><span style="color: #C9D1D9">, </span><span style="color: #FFA657">input</span><span style="color: #C9D1D9">) </span><span style="color: #FF7B72">=&gt;</span><span style="color: #C9D1D9"> {</span></span>
<span class=line><span style="color: #C9D1D9">  </span><span style="color: #FF7B72">if</span><span style="color: #C9D1D9"> (</span><span style="color: #D2A8FF">predicate</span><span style="color: #C9D1D9">(input)) {</span></span>
<span class=line><span style="color: #C9D1D9">    result.</span><span style="color: #D2A8FF">push</span><span style="color: #C9D1D9">(input);</span></span>
<span class=line><span style="color: #C9D1D9">  }</span></span>
<span class=line><span style="color: #C9D1D9">  </span><span style="color: #FF7B72">return</span><span style="color: #C9D1D9"> result;</span></span>
<span class=line><span style="color: #C9D1D9">};</span></span>
<span class=line></span>
<span class=line><span style="color: #C9D1D9">[</span><span style="color: #79C0FF">1</span><span style="color: #C9D1D9">, </span><span style="color: #79C0FF">2</span><span style="color: #C9D1D9">, </span><span style="color: #79C0FF">3</span><span style="color: #C9D1D9">, </span><span style="color: #79C0FF">4</span><span style="color: #C9D1D9">, </span><span style="color: #79C0FF">5</span><span style="color: #C9D1D9">, </span><span style="color: #79C0FF">6</span><span style="color: #C9D1D9">, </span><span style="color: #79C0FF">7</span><span style="color: #C9D1D9">, </span><span style="color: #79C0FF">8</span><span style="color: #C9D1D9">, </span><span style="color: #79C0FF">9</span><span style="color: #C9D1D9">, </span><span style="color: #79C0FF">10</span><span style="color: #C9D1D9">].</span><span style="color: #D2A8FF">reduce</span><span style="color: #C9D1D9">(</span><span style="color: #D2A8FF">filterReducer</span><span style="color: #C9D1D9">((</span><span style="color: #FFA657">x</span><span style="color: #C9D1D9">) </span><span style="color: #FF7B72">=&gt;</span><span style="color: #C9D1D9"> x </span><span style="color: #FF7B72">%</span><span style="color: #C9D1D9"> </span><span style="color: #79C0FF">2</span><span style="color: #C9D1D9"> </span><span style="color: #FF7B72">===</span><span style="color: #C9D1D9"> </span><span style="color: #79C0FF">0</span><span style="color: #C9D1D9">), []);</span></span>
<span class=line><span style="color: #8B949E">// [2, 4, 6, 8, 10]</span></span></code></pre></div>
</code></pre><p>因此我们把一开始的例子改写成这样：</p><pre><code class=language-js><div class=shiki-light><pre class=shiki style="background-color: #ffffff"><code><span class=line><span style="color: #24292E">[</span><span style="color: #005CC5">0</span><span style="color: #24292E">, </span><span style="color: #005CC5">1</span><span style="color: #24292E">, </span><span style="color: #005CC5">2</span><span style="color: #24292E">, </span><span style="color: #005CC5">3</span><span style="color: #24292E">, </span><span style="color: #005CC5">4</span><span style="color: #24292E">, </span><span style="color: #005CC5">5</span><span style="color: #24292E">, </span><span style="color: #005CC5">6</span><span style="color: #24292E">, </span><span style="color: #005CC5">7</span><span style="color: #24292E">, </span><span style="color: #005CC5">8</span><span style="color: #24292E">, </span><span style="color: #005CC5">9</span><span style="color: #24292E">]</span></span>
<span class=line><span style="color: #24292E">  .</span><span style="color: #6F42C1">reduce</span><span style="color: #24292E">(</span><span style="color: #6F42C1">mapReducer</span><span style="color: #24292E">((</span><span style="color: #E36209">x</span><span style="color: #24292E">) </span><span style="color: #D73A49">=&gt;</span><span style="color: #24292E"> x </span><span style="color: #D73A49">+</span><span style="color: #24292E"> </span><span style="color: #005CC5">1</span><span style="color: #24292E">), [])</span></span>
<span class=line><span style="color: #24292E">  .</span><span style="color: #6F42C1">reduce</span><span style="color: #24292E">(</span><span style="color: #6F42C1">filterReducer</span><span style="color: #24292E">((</span><span style="color: #E36209">x</span><span style="color: #24292E">) </span><span style="color: #D73A49">=&gt;</span><span style="color: #24292E"> x </span><span style="color: #D73A49">%</span><span style="color: #24292E"> </span><span style="color: #005CC5">2</span><span style="color: #24292E"> </span><span style="color: #D73A49">===</span><span style="color: #24292E"> </span><span style="color: #005CC5">0</span><span style="color: #24292E">), []);</span></span>
<span class=line><span style="color: #6A737D">// [2, 4, 6, 8, 10]</span></span></code></pre></div><div class=shiki-dark><pre class=shiki style="background-color: #0d1117"><code><span class=line><span style="color: #C9D1D9">[</span><span style="color: #79C0FF">0</span><span style="color: #C9D1D9">, </span><span style="color: #79C0FF">1</span><span style="color: #C9D1D9">, </span><span style="color: #79C0FF">2</span><span style="color: #C9D1D9">, </span><span style="color: #79C0FF">3</span><span style="color: #C9D1D9">, </span><span style="color: #79C0FF">4</span><span style="color: #C9D1D9">, </span><span style="color: #79C0FF">5</span><span style="color: #C9D1D9">, </span><span style="color: #79C0FF">6</span><span style="color: #C9D1D9">, </span><span style="color: #79C0FF">7</span><span style="color: #C9D1D9">, </span><span style="color: #79C0FF">8</span><span style="color: #C9D1D9">, </span><span style="color: #79C0FF">9</span><span style="color: #C9D1D9">]</span></span>
<span class=line><span style="color: #C9D1D9">  .</span><span style="color: #D2A8FF">reduce</span><span style="color: #C9D1D9">(</span><span style="color: #D2A8FF">mapReducer</span><span style="color: #C9D1D9">((</span><span style="color: #FFA657">x</span><span style="color: #C9D1D9">) </span><span style="color: #FF7B72">=&gt;</span><span style="color: #C9D1D9"> x </span><span style="color: #FF7B72">+</span><span style="color: #C9D1D9"> </span><span style="color: #79C0FF">1</span><span style="color: #C9D1D9">), [])</span></span>
<span class=line><span style="color: #C9D1D9">  .</span><span style="color: #D2A8FF">reduce</span><span style="color: #C9D1D9">(</span><span style="color: #D2A8FF">filterReducer</span><span style="color: #C9D1D9">((</span><span style="color: #FFA657">x</span><span style="color: #C9D1D9">) </span><span style="color: #FF7B72">=&gt;</span><span style="color: #C9D1D9"> x </span><span style="color: #FF7B72">%</span><span style="color: #C9D1D9"> </span><span style="color: #79C0FF">2</span><span style="color: #C9D1D9"> </span><span style="color: #FF7B72">===</span><span style="color: #C9D1D9"> </span><span style="color: #79C0FF">0</span><span style="color: #C9D1D9">), []);</span></span>
<span class=line><span style="color: #8B949E">// [2, 4, 6, 8, 10]</span></span></code></pre></div>
</code></pre><p>在这两个 reduce 里我们都使用了 push，实际上加减乘除和 push 等方法都是算作 reducing function，他们接受一个初始值和输入，然后 reduce 成一个单一的结果，如果了解 clojure 这样 lisp 风格的语言，他们的写法其实看上去都差不多：</p><pre><code class=language-clj><div class=shiki-light><pre class=shiki style="background-color: #ffffff"><code><span class=line><span style="color: #24292E">(</span><span style="color: #6F42C1">+</span><span style="color: #24292E"> </span><span style="color: #005CC5">3</span><span style="color: #24292E"> </span><span style="color: #005CC5">4</span><span style="color: #24292E">)</span></span>
<span class=line><span style="color: #6A737D">;;7</span></span>
<span class=line></span>
<span class=line><span style="color: #24292E">(</span><span style="color: #6F42C1">inc</span><span style="color: #24292E"> </span><span style="color: #005CC5">10</span><span style="color: #24292E">)</span></span>
<span class=line><span style="color: #6A737D">;; 11</span></span></code></pre></div><div class=shiki-dark><pre class=shiki style="background-color: #0d1117"><code><span class=line><span style="color: #C9D1D9">(</span><span style="color: #D2A8FF">+</span><span style="color: #C9D1D9"> </span><span style="color: #79C0FF">3</span><span style="color: #C9D1D9"> </span><span style="color: #79C0FF">4</span><span style="color: #C9D1D9">)</span></span>
<span class=line><span style="color: #8B949E">;;7</span></span>
<span class=line></span>
<span class=line><span style="color: #C9D1D9">(</span><span style="color: #D2A8FF">inc</span><span style="color: #C9D1D9"> </span><span style="color: #79C0FF">10</span><span style="color: #C9D1D9">)</span></span>
<span class=line><span style="color: #8B949E">;; 11</span></span></code></pre></div>
</code></pre><p>我们可以进一步把这些 reducing function 再抽出来：</p><pre><code class=language-js><div class=shiki-light><pre class=shiki style="background-color: #ffffff"><code><span class=line><span style="color: #D73A49">const</span><span style="color: #24292E"> </span><span style="color: #6F42C1">mapping</span><span style="color: #24292E"> </span><span style="color: #D73A49">=</span><span style="color: #24292E"> (</span><span style="color: #E36209">f</span><span style="color: #24292E">) </span><span style="color: #D73A49">=&gt;</span><span style="color: #24292E"> (</span><span style="color: #E36209">reducing</span><span style="color: #24292E">) </span><span style="color: #D73A49">=&gt;</span><span style="color: #24292E"> (</span><span style="color: #E36209">result</span><span style="color: #24292E">, </span><span style="color: #E36209">input</span><span style="color: #24292E">) </span><span style="color: #D73A49">=&gt;</span><span style="color: #24292E"> </span><span style="color: #6F42C1">reducing</span><span style="color: #24292E">(result, </span><span style="color: #6F42C1">f</span><span style="color: #24292E">(input));</span></span>
<span class=line></span>
<span class=line><span style="color: #D73A49">const</span><span style="color: #24292E"> </span><span style="color: #6F42C1">filtering</span><span style="color: #24292E"> </span><span style="color: #D73A49">=</span><span style="color: #24292E"> (</span><span style="color: #E36209">predicate</span><span style="color: #24292E">) </span><span style="color: #D73A49">=&gt;</span><span style="color: #24292E"> (</span><span style="color: #E36209">reducing</span><span style="color: #24292E">) </span><span style="color: #D73A49">=&gt;</span><span style="color: #24292E"> (</span><span style="color: #E36209">result</span><span style="color: #24292E">, </span><span style="color: #E36209">input</span><span style="color: #24292E">) </span><span style="color: #D73A49">=&gt;</span><span style="color: #24292E"> </span><span style="color: #6F42C1">predicate</span><span style="color: #24292E">(input) </span><span style="color: #D73A49">?</span><span style="color: #24292E"> </span><span style="color: #6F42C1">reducing</span><span style="color: #24292E">(result, input) </span><span style="color: #D73A49">:</span><span style="color: #24292E"> result;</span></span></code></pre></div><div class=shiki-dark><pre class=shiki style="background-color: #0d1117"><code><span class=line><span style="color: #FF7B72">const</span><span style="color: #C9D1D9"> </span><span style="color: #D2A8FF">mapping</span><span style="color: #C9D1D9"> </span><span style="color: #FF7B72">=</span><span style="color: #C9D1D9"> (</span><span style="color: #FFA657">f</span><span style="color: #C9D1D9">) </span><span style="color: #FF7B72">=&gt;</span><span style="color: #C9D1D9"> (</span><span style="color: #FFA657">reducing</span><span style="color: #C9D1D9">) </span><span style="color: #FF7B72">=&gt;</span><span style="color: #C9D1D9"> (</span><span style="color: #FFA657">result</span><span style="color: #C9D1D9">, </span><span style="color: #FFA657">input</span><span style="color: #C9D1D9">) </span><span style="color: #FF7B72">=&gt;</span><span style="color: #C9D1D9"> </span><span style="color: #D2A8FF">reducing</span><span style="color: #C9D1D9">(result, </span><span style="color: #D2A8FF">f</span><span style="color: #C9D1D9">(input));</span></span>
<span class=line></span>
<span class=line><span style="color: #FF7B72">const</span><span style="color: #C9D1D9"> </span><span style="color: #D2A8FF">filtering</span><span style="color: #C9D1D9"> </span><span style="color: #FF7B72">=</span><span style="color: #C9D1D9"> (</span><span style="color: #FFA657">predicate</span><span style="color: #C9D1D9">) </span><span style="color: #FF7B72">=&gt;</span><span style="color: #C9D1D9"> (</span><span style="color: #FFA657">reducing</span><span style="color: #C9D1D9">) </span><span style="color: #FF7B72">=&gt;</span><span style="color: #C9D1D9"> (</span><span style="color: #FFA657">result</span><span style="color: #C9D1D9">, </span><span style="color: #FFA657">input</span><span style="color: #C9D1D9">) </span><span style="color: #FF7B72">=&gt;</span><span style="color: #C9D1D9"> </span><span style="color: #D2A8FF">predicate</span><span style="color: #C9D1D9">(input) </span><span style="color: #FF7B72">?</span><span style="color: #C9D1D9"> </span><span style="color: #D2A8FF">reducing</span><span style="color: #C9D1D9">(result, input) </span><span style="color: #FF7B72">:</span><span style="color: #C9D1D9"> result;</span></span></code></pre></div>
</code></pre><p>然后像下面这样使用：</p><pre><code class=language-js><div class=shiki-light><pre class=shiki style="background-color: #ffffff"><code><span class=line><span style="color: #24292E">[</span><span style="color: #005CC5">0</span><span style="color: #24292E">, </span><span style="color: #005CC5">1</span><span style="color: #24292E">, </span><span style="color: #005CC5">2</span><span style="color: #24292E">, </span><span style="color: #005CC5">3</span><span style="color: #24292E">, </span><span style="color: #005CC5">4</span><span style="color: #24292E">, </span><span style="color: #005CC5">5</span><span style="color: #24292E">, </span><span style="color: #005CC5">6</span><span style="color: #24292E">, </span><span style="color: #005CC5">7</span><span style="color: #24292E">, </span><span style="color: #005CC5">8</span><span style="color: #24292E">, </span><span style="color: #005CC5">9</span><span style="color: #24292E">]</span></span>
<span class=line><span style="color: #24292E">  .</span><span style="color: #6F42C1">reduce</span><span style="color: #24292E">(</span><span style="color: #6F42C1">mapping</span><span style="color: #24292E">(</span><span style="color: #E36209">x</span><span style="color: #24292E"> </span><span style="color: #D73A49">=&gt;</span><span style="color: #24292E"> x </span><span style="color: #D73A49">+</span><span style="color: #24292E"> </span><span style="color: #005CC5">1</span><span style="color: #24292E">)((</span><span style="color: #E36209">xs</span><span style="color: #24292E">, </span><span style="color: #E36209">x</span><span style="color: #24292E">) </span><span style="color: #D73A49">=&gt;</span><span style="color: #24292E"> {</span></span>
<span class=line><span style="color: #24292E">    xs.</span><span style="color: #6F42C1">push</span><span style="color: #24292E">(x);</span></span>
<span class=line><span style="color: #24292E">    </span><span style="color: #D73A49">return</span><span style="color: #24292E"> xs;</span></span>
<span class=line><span style="color: #24292E">  }), [])</span></span>
<span class=line><span style="color: #24292E">  .</span><span style="color: #6F42C1">reduce</span><span style="color: #24292E">(</span><span style="color: #6F42C1">filtering</span><span style="color: #24292E">(</span><span style="color: #E36209">x</span><span style="color: #24292E"> </span><span style="color: #D73A49">=&gt;</span><span style="color: #24292E"> x </span><span style="color: #D73A49">%</span><span style="color: #24292E"> </span><span style="color: #005CC5">2</span><span style="color: #24292E"> </span><span style="color: #D73A49">===</span><span style="color: #24292E"> </span><span style="color: #005CC5">0</span><span style="color: #24292E">)((</span><span style="color: #E36209">xs</span><span style="color: #24292E">, </span><span style="color: #E36209">x</span><span style="color: #24292E">) </span><span style="color: #D73A49">=&gt;</span><span style="color: #24292E"> {</span></span>
<span class=line><span style="color: #24292E">    xs.</span><span style="color: #6F42C1">push</span><span style="color: #24292E">(x);</span></span>
<span class=line><span style="color: #24292E">    </span><span style="color: #D73A49">return</span><span style="color: #24292E"> xs;</span></span>
<span class=line><span style="color: #24292E">  }), []);</span></span>
<span class=line><span style="color: #6A737D">// [2, 4, 6, 8, 10]</span></span></code></pre></div><div class=shiki-dark><pre class=shiki style="background-color: #0d1117"><code><span class=line><span style="color: #C9D1D9">[</span><span style="color: #79C0FF">0</span><span style="color: #C9D1D9">, </span><span style="color: #79C0FF">1</span><span style="color: #C9D1D9">, </span><span style="color: #79C0FF">2</span><span style="color: #C9D1D9">, </span><span style="color: #79C0FF">3</span><span style="color: #C9D1D9">, </span><span style="color: #79C0FF">4</span><span style="color: #C9D1D9">, </span><span style="color: #79C0FF">5</span><span style="color: #C9D1D9">, </span><span style="color: #79C0FF">6</span><span style="color: #C9D1D9">, </span><span style="color: #79C0FF">7</span><span style="color: #C9D1D9">, </span><span style="color: #79C0FF">8</span><span style="color: #C9D1D9">, </span><span style="color: #79C0FF">9</span><span style="color: #C9D1D9">]</span></span>
<span class=line><span style="color: #C9D1D9">  .</span><span style="color: #D2A8FF">reduce</span><span style="color: #C9D1D9">(</span><span style="color: #D2A8FF">mapping</span><span style="color: #C9D1D9">(</span><span style="color: #FFA657">x</span><span style="color: #C9D1D9"> </span><span style="color: #FF7B72">=&gt;</span><span style="color: #C9D1D9"> x </span><span style="color: #FF7B72">+</span><span style="color: #C9D1D9"> </span><span style="color: #79C0FF">1</span><span style="color: #C9D1D9">)((</span><span style="color: #FFA657">xs</span><span style="color: #C9D1D9">, </span><span style="color: #FFA657">x</span><span style="color: #C9D1D9">) </span><span style="color: #FF7B72">=&gt;</span><span style="color: #C9D1D9"> {</span></span>
<span class=line><span style="color: #C9D1D9">    xs.</span><span style="color: #D2A8FF">push</span><span style="color: #C9D1D9">(x);</span></span>
<span class=line><span style="color: #C9D1D9">    </span><span style="color: #FF7B72">return</span><span style="color: #C9D1D9"> xs;</span></span>
<span class=line><span style="color: #C9D1D9">  }), [])</span></span>
<span class=line><span style="color: #C9D1D9">  .</span><span style="color: #D2A8FF">reduce</span><span style="color: #C9D1D9">(</span><span style="color: #D2A8FF">filtering</span><span style="color: #C9D1D9">(</span><span style="color: #FFA657">x</span><span style="color: #C9D1D9"> </span><span style="color: #FF7B72">=&gt;</span><span style="color: #C9D1D9"> x </span><span style="color: #FF7B72">%</span><span style="color: #C9D1D9"> </span><span style="color: #79C0FF">2</span><span style="color: #C9D1D9"> </span><span style="color: #FF7B72">===</span><span style="color: #C9D1D9"> </span><span style="color: #79C0FF">0</span><span style="color: #C9D1D9">)((</span><span style="color: #FFA657">xs</span><span style="color: #C9D1D9">, </span><span style="color: #FFA657">x</span><span style="color: #C9D1D9">) </span><span style="color: #FF7B72">=&gt;</span><span style="color: #C9D1D9"> {</span></span>
<span class=line><span style="color: #C9D1D9">    xs.</span><span style="color: #D2A8FF">push</span><span style="color: #C9D1D9">(x);</span></span>
<span class=line><span style="color: #C9D1D9">    </span><span style="color: #FF7B72">return</span><span style="color: #C9D1D9"> xs;</span></span>
<span class=line><span style="color: #C9D1D9">  }), []);</span></span>
<span class=line><span style="color: #8B949E">// [2, 4, 6, 8, 10]</span></span></code></pre></div>
</code></pre><p>看到这里可能已经有点晕了，不过其实很简单，我们只是延迟执行，传入了两个函数在 reduce 的时候调用而已。reducer 总是符合这样的模式：<code>result, input -&gt; result</code>：</p><pre><code class=language-js><div class=shiki-light><pre class=shiki style="background-color: #ffffff"><code><span class=line><span style="color: #6F42C1">mapping</span><span style="color: #24292E">(</span><span style="color: #E36209">x</span><span style="color: #24292E"> </span><span style="color: #D73A49">=&gt;</span><span style="color: #24292E"> x </span><span style="color: #D73A49">+</span><span style="color: #24292E"> </span><span style="color: #005CC5">1</span><span style="color: #24292E">)((</span><span style="color: #E36209">xs</span><span style="color: #24292E">, </span><span style="color: #E36209">x</span><span style="color: #24292E">) </span><span style="color: #D73A49">=&gt;</span><span style="color: #24292E"> {</span></span>
<span class=line><span style="color: #24292E">  xs.</span><span style="color: #6F42C1">push</span><span style="color: #24292E">(x);</span></span>
<span class=line><span style="color: #24292E">  </span><span style="color: #D73A49">return</span><span style="color: #24292E"> xs;</span></span>
<span class=line><span style="color: #24292E">})([], </span><span style="color: #005CC5">1</span><span style="color: #24292E">);</span></span>
<span class=line><span style="color: #6A737D">// [2]</span></span>
<span class=line></span>
<span class=line><span style="color: #6F42C1">mapping</span><span style="color: #24292E">(</span><span style="color: #E36209">x</span><span style="color: #24292E"> </span><span style="color: #D73A49">=&gt;</span><span style="color: #24292E"> x </span><span style="color: #D73A49">+</span><span style="color: #24292E"> </span><span style="color: #005CC5">1</span><span style="color: #24292E">)((</span><span style="color: #E36209">xs</span><span style="color: #24292E">, </span><span style="color: #E36209">x</span><span style="color: #24292E">) </span><span style="color: #D73A49">=&gt;</span><span style="color: #24292E"> {</span></span>
<span class=line><span style="color: #24292E">  xs.</span><span style="color: #6F42C1">push</span><span style="color: #24292E">(x);</span></span>
<span class=line><span style="color: #24292E">  </span><span style="color: #D73A49">return</span><span style="color: #24292E"> xs;</span></span>
<span class=line><span style="color: #24292E">})([</span><span style="color: #005CC5">2</span><span style="color: #24292E">], </span><span style="color: #005CC5">2</span><span style="color: #24292E">);</span></span>
<span class=line><span style="color: #6A737D">// [2, 3]</span></span>
<span class=line></span>
<span class=line><span style="color: #6F42C1">mapping</span><span style="color: #24292E">(</span><span style="color: #E36209">x</span><span style="color: #24292E"> </span><span style="color: #D73A49">=&gt;</span><span style="color: #24292E"> x </span><span style="color: #D73A49">+</span><span style="color: #24292E"> </span><span style="color: #005CC5">1</span><span style="color: #24292E">)((</span><span style="color: #E36209">xs</span><span style="color: #24292E">, </span><span style="color: #E36209">x</span><span style="color: #24292E">) </span><span style="color: #D73A49">=&gt;</span><span style="color: #24292E"> {</span></span>
<span class=line><span style="color: #24292E">  xs.</span><span style="color: #6F42C1">push</span><span style="color: #24292E">(x);</span></span>
<span class=line><span style="color: #24292E">  </span><span style="color: #D73A49">return</span><span style="color: #24292E"> xs;</span></span>
<span class=line><span style="color: #24292E">})([</span><span style="color: #005CC5">2</span><span style="color: #24292E">, </span><span style="color: #005CC5">3</span><span style="color: #24292E">], </span><span style="color: #005CC5">3</span><span style="color: #24292E">);</span></span>
<span class=line><span style="color: #6A737D">// [2, 3, 4]</span></span>
<span class=line></span>
<span class=line><span style="color: #6F42C1">filtering</span><span style="color: #24292E">(</span><span style="color: #E36209">x</span><span style="color: #24292E"> </span><span style="color: #D73A49">=&gt;</span><span style="color: #24292E"> x </span><span style="color: #D73A49">%</span><span style="color: #24292E"> </span><span style="color: #005CC5">2</span><span style="color: #24292E"> </span><span style="color: #D73A49">===</span><span style="color: #24292E"> </span><span style="color: #005CC5">0</span><span style="color: #24292E">)((</span><span style="color: #E36209">xs</span><span style="color: #24292E">, </span><span style="color: #E36209">x</span><span style="color: #24292E">) </span><span style="color: #D73A49">=&gt;</span><span style="color: #24292E"> {</span></span>
<span class=line><span style="color: #24292E">  xs.</span><span style="color: #6F42C1">push</span><span style="color: #24292E">(x);</span></span>
<span class=line><span style="color: #24292E">  </span><span style="color: #D73A49">return</span><span style="color: #24292E"> xs;</span></span>
<span class=line><span style="color: #24292E">})([</span><span style="color: #005CC5">2</span><span style="color: #24292E">, </span><span style="color: #005CC5">4</span><span style="color: #24292E">], </span><span style="color: #005CC5">5</span><span style="color: #24292E">);</span></span>
<span class=line><span style="color: #6A737D">// [2, 4]</span></span>
<span class=line></span>
<span class=line><span style="color: #6F42C1">filtering</span><span style="color: #24292E">(</span><span style="color: #E36209">x</span><span style="color: #24292E"> </span><span style="color: #D73A49">=&gt;</span><span style="color: #24292E"> x </span><span style="color: #D73A49">%</span><span style="color: #24292E"> </span><span style="color: #005CC5">2</span><span style="color: #24292E"> </span><span style="color: #D73A49">===</span><span style="color: #24292E"> </span><span style="color: #005CC5">0</span><span style="color: #24292E">)((</span><span style="color: #E36209">xs</span><span style="color: #24292E">, </span><span style="color: #E36209">x</span><span style="color: #24292E">) </span><span style="color: #D73A49">=&gt;</span><span style="color: #24292E"> {</span></span>
<span class=line><span style="color: #24292E">  xs.</span><span style="color: #6F42C1">push</span><span style="color: #24292E">(x);</span></span>
<span class=line><span style="color: #24292E">  </span><span style="color: #D73A49">return</span><span style="color: #24292E"> xs;</span></span>
<span class=line><span style="color: #24292E">})([</span><span style="color: #005CC5">2</span><span style="color: #24292E">, </span><span style="color: #005CC5">4</span><span style="color: #24292E">], </span><span style="color: #005CC5">6</span><span style="color: #24292E">);</span></span>
<span class=line><span style="color: #6A737D">// [2, 4, 6]</span></span></code></pre></div><div class=shiki-dark><pre class=shiki style="background-color: #0d1117"><code><span class=line><span style="color: #D2A8FF">mapping</span><span style="color: #C9D1D9">(</span><span style="color: #FFA657">x</span><span style="color: #C9D1D9"> </span><span style="color: #FF7B72">=&gt;</span><span style="color: #C9D1D9"> x </span><span style="color: #FF7B72">+</span><span style="color: #C9D1D9"> </span><span style="color: #79C0FF">1</span><span style="color: #C9D1D9">)((</span><span style="color: #FFA657">xs</span><span style="color: #C9D1D9">, </span><span style="color: #FFA657">x</span><span style="color: #C9D1D9">) </span><span style="color: #FF7B72">=&gt;</span><span style="color: #C9D1D9"> {</span></span>
<span class=line><span style="color: #C9D1D9">  xs.</span><span style="color: #D2A8FF">push</span><span style="color: #C9D1D9">(x);</span></span>
<span class=line><span style="color: #C9D1D9">  </span><span style="color: #FF7B72">return</span><span style="color: #C9D1D9"> xs;</span></span>
<span class=line><span style="color: #C9D1D9">})([], </span><span style="color: #79C0FF">1</span><span style="color: #C9D1D9">);</span></span>
<span class=line><span style="color: #8B949E">// [2]</span></span>
<span class=line></span>
<span class=line><span style="color: #D2A8FF">mapping</span><span style="color: #C9D1D9">(</span><span style="color: #FFA657">x</span><span style="color: #C9D1D9"> </span><span style="color: #FF7B72">=&gt;</span><span style="color: #C9D1D9"> x </span><span style="color: #FF7B72">+</span><span style="color: #C9D1D9"> </span><span style="color: #79C0FF">1</span><span style="color: #C9D1D9">)((</span><span style="color: #FFA657">xs</span><span style="color: #C9D1D9">, </span><span style="color: #FFA657">x</span><span style="color: #C9D1D9">) </span><span style="color: #FF7B72">=&gt;</span><span style="color: #C9D1D9"> {</span></span>
<span class=line><span style="color: #C9D1D9">  xs.</span><span style="color: #D2A8FF">push</span><span style="color: #C9D1D9">(x);</span></span>
<span class=line><span style="color: #C9D1D9">  </span><span style="color: #FF7B72">return</span><span style="color: #C9D1D9"> xs;</span></span>
<span class=line><span style="color: #C9D1D9">})([</span><span style="color: #79C0FF">2</span><span style="color: #C9D1D9">], </span><span style="color: #79C0FF">2</span><span style="color: #C9D1D9">);</span></span>
<span class=line><span style="color: #8B949E">// [2, 3]</span></span>
<span class=line></span>
<span class=line><span style="color: #D2A8FF">mapping</span><span style="color: #C9D1D9">(</span><span style="color: #FFA657">x</span><span style="color: #C9D1D9"> </span><span style="color: #FF7B72">=&gt;</span><span style="color: #C9D1D9"> x </span><span style="color: #FF7B72">+</span><span style="color: #C9D1D9"> </span><span style="color: #79C0FF">1</span><span style="color: #C9D1D9">)((</span><span style="color: #FFA657">xs</span><span style="color: #C9D1D9">, </span><span style="color: #FFA657">x</span><span style="color: #C9D1D9">) </span><span style="color: #FF7B72">=&gt;</span><span style="color: #C9D1D9"> {</span></span>
<span class=line><span style="color: #C9D1D9">  xs.</span><span style="color: #D2A8FF">push</span><span style="color: #C9D1D9">(x);</span></span>
<span class=line><span style="color: #C9D1D9">  </span><span style="color: #FF7B72">return</span><span style="color: #C9D1D9"> xs;</span></span>
<span class=line><span style="color: #C9D1D9">})([</span><span style="color: #79C0FF">2</span><span style="color: #C9D1D9">, </span><span style="color: #79C0FF">3</span><span style="color: #C9D1D9">], </span><span style="color: #79C0FF">3</span><span style="color: #C9D1D9">);</span></span>
<span class=line><span style="color: #8B949E">// [2, 3, 4]</span></span>
<span class=line></span>
<span class=line><span style="color: #D2A8FF">filtering</span><span style="color: #C9D1D9">(</span><span style="color: #FFA657">x</span><span style="color: #C9D1D9"> </span><span style="color: #FF7B72">=&gt;</span><span style="color: #C9D1D9"> x </span><span style="color: #FF7B72">%</span><span style="color: #C9D1D9"> </span><span style="color: #79C0FF">2</span><span style="color: #C9D1D9"> </span><span style="color: #FF7B72">===</span><span style="color: #C9D1D9"> </span><span style="color: #79C0FF">0</span><span style="color: #C9D1D9">)((</span><span style="color: #FFA657">xs</span><span style="color: #C9D1D9">, </span><span style="color: #FFA657">x</span><span style="color: #C9D1D9">) </span><span style="color: #FF7B72">=&gt;</span><span style="color: #C9D1D9"> {</span></span>
<span class=line><span style="color: #C9D1D9">  xs.</span><span style="color: #D2A8FF">push</span><span style="color: #C9D1D9">(x);</span></span>
<span class=line><span style="color: #C9D1D9">  </span><span style="color: #FF7B72">return</span><span style="color: #C9D1D9"> xs;</span></span>
<span class=line><span style="color: #C9D1D9">})([</span><span style="color: #79C0FF">2</span><span style="color: #C9D1D9">, </span><span style="color: #79C0FF">4</span><span style="color: #C9D1D9">], </span><span style="color: #79C0FF">5</span><span style="color: #C9D1D9">);</span></span>
<span class=line><span style="color: #8B949E">// [2, 4]</span></span>
<span class=line></span>
<span class=line><span style="color: #D2A8FF">filtering</span><span style="color: #C9D1D9">(</span><span style="color: #FFA657">x</span><span style="color: #C9D1D9"> </span><span style="color: #FF7B72">=&gt;</span><span style="color: #C9D1D9"> x </span><span style="color: #FF7B72">%</span><span style="color: #C9D1D9"> </span><span style="color: #79C0FF">2</span><span style="color: #C9D1D9"> </span><span style="color: #FF7B72">===</span><span style="color: #C9D1D9"> </span><span style="color: #79C0FF">0</span><span style="color: #C9D1D9">)((</span><span style="color: #FFA657">xs</span><span style="color: #C9D1D9">, </span><span style="color: #FFA657">x</span><span style="color: #C9D1D9">) </span><span style="color: #FF7B72">=&gt;</span><span style="color: #C9D1D9"> {</span></span>
<span class=line><span style="color: #C9D1D9">  xs.</span><span style="color: #D2A8FF">push</span><span style="color: #C9D1D9">(x);</span></span>
<span class=line><span style="color: #C9D1D9">  </span><span style="color: #FF7B72">return</span><span style="color: #C9D1D9"> xs;</span></span>
<span class=line><span style="color: #C9D1D9">})([</span><span style="color: #79C0FF">2</span><span style="color: #C9D1D9">, </span><span style="color: #79C0FF">4</span><span style="color: #C9D1D9">], </span><span style="color: #79C0FF">6</span><span style="color: #C9D1D9">);</span></span>
<span class=line><span style="color: #8B949E">// [2, 4, 6]</span></span></code></pre></div>
</code></pre><p>我们再回到上面 mapping 和 filtering：</p><pre><code class=language-js><div class=shiki-light><pre class=shiki style="background-color: #ffffff"><code><span class=line><span style="color: #D73A49">const</span><span style="color: #24292E"> </span><span style="color: #6F42C1">mapping</span><span style="color: #24292E"> </span><span style="color: #D73A49">=</span><span style="color: #24292E"> (</span><span style="color: #E36209">f</span><span style="color: #24292E">) </span><span style="color: #D73A49">=&gt;</span><span style="color: #24292E"> (</span><span style="color: #E36209">reducing</span><span style="color: #24292E">) </span><span style="color: #D73A49">=&gt;</span><span style="color: #24292E"> (</span><span style="color: #E36209">result</span><span style="color: #24292E">, </span><span style="color: #E36209">input</span><span style="color: #24292E">) </span><span style="color: #D73A49">=&gt;</span><span style="color: #24292E"> </span><span style="color: #6F42C1">reducing</span><span style="color: #24292E">(result, </span><span style="color: #6F42C1">f</span><span style="color: #24292E">(input));</span></span>
<span class=line></span>
<span class=line><span style="color: #D73A49">const</span><span style="color: #24292E"> </span><span style="color: #6F42C1">filtering</span><span style="color: #24292E"> </span><span style="color: #D73A49">=</span><span style="color: #24292E"> (</span><span style="color: #E36209">predicate</span><span style="color: #24292E">) </span><span style="color: #D73A49">=&gt;</span><span style="color: #24292E"> (</span><span style="color: #E36209">reducing</span><span style="color: #24292E">) </span><span style="color: #D73A49">=&gt;</span><span style="color: #24292E"> (</span><span style="color: #E36209">result</span><span style="color: #24292E">, </span><span style="color: #E36209">input</span><span style="color: #24292E">) </span><span style="color: #D73A49">=&gt;</span><span style="color: #24292E"> </span><span style="color: #6F42C1">predicate</span><span style="color: #24292E">(input) </span><span style="color: #D73A49">?</span><span style="color: #24292E"> </span><span style="color: #6F42C1">reducing</span><span style="color: #24292E">(result, input) </span><span style="color: #D73A49">:</span><span style="color: #24292E"> result;</span></span></code></pre></div><div class=shiki-dark><pre class=shiki style="background-color: #0d1117"><code><span class=line><span style="color: #FF7B72">const</span><span style="color: #C9D1D9"> </span><span style="color: #D2A8FF">mapping</span><span style="color: #C9D1D9"> </span><span style="color: #FF7B72">=</span><span style="color: #C9D1D9"> (</span><span style="color: #FFA657">f</span><span style="color: #C9D1D9">) </span><span style="color: #FF7B72">=&gt;</span><span style="color: #C9D1D9"> (</span><span style="color: #FFA657">reducing</span><span style="color: #C9D1D9">) </span><span style="color: #FF7B72">=&gt;</span><span style="color: #C9D1D9"> (</span><span style="color: #FFA657">result</span><span style="color: #C9D1D9">, </span><span style="color: #FFA657">input</span><span style="color: #C9D1D9">) </span><span style="color: #FF7B72">=&gt;</span><span style="color: #C9D1D9"> </span><span style="color: #D2A8FF">reducing</span><span style="color: #C9D1D9">(result, </span><span style="color: #D2A8FF">f</span><span style="color: #C9D1D9">(input));</span></span>
<span class=line></span>
<span class=line><span style="color: #FF7B72">const</span><span style="color: #C9D1D9"> </span><span style="color: #D2A8FF">filtering</span><span style="color: #C9D1D9"> </span><span style="color: #FF7B72">=</span><span style="color: #C9D1D9"> (</span><span style="color: #FFA657">predicate</span><span style="color: #C9D1D9">) </span><span style="color: #FF7B72">=&gt;</span><span style="color: #C9D1D9"> (</span><span style="color: #FFA657">reducing</span><span style="color: #C9D1D9">) </span><span style="color: #FF7B72">=&gt;</span><span style="color: #C9D1D9"> (</span><span style="color: #FFA657">result</span><span style="color: #C9D1D9">, </span><span style="color: #FFA657">input</span><span style="color: #C9D1D9">) </span><span style="color: #FF7B72">=&gt;</span><span style="color: #C9D1D9"> </span><span style="color: #D2A8FF">predicate</span><span style="color: #C9D1D9">(input) </span><span style="color: #FF7B72">?</span><span style="color: #C9D1D9"> </span><span style="color: #D2A8FF">reducing</span><span style="color: #C9D1D9">(result, input) </span><span style="color: #FF7B72">:</span><span style="color: #C9D1D9"> result;</span></span></code></pre></div>
</code></pre><p>我们将其组合一下，也完全符合这种模式！</p><pre><code class=language-js><div class=shiki-light><pre class=shiki style="background-color: #ffffff"><code><span class=line><span style="color: #6F42C1">mapping</span><span style="color: #24292E">(</span><span style="color: #E36209">x</span><span style="color: #24292E"> </span><span style="color: #D73A49">=&gt;</span><span style="color: #24292E"> x </span><span style="color: #D73A49">+</span><span style="color: #24292E"> </span><span style="color: #005CC5">1</span><span style="color: #24292E">)(</span><span style="color: #6F42C1">filtering</span><span style="color: #24292E">(</span><span style="color: #E36209">x</span><span style="color: #24292E"> </span><span style="color: #D73A49">=&gt;</span><span style="color: #24292E"> x </span><span style="color: #D73A49">%</span><span style="color: #24292E"> </span><span style="color: #005CC5">2</span><span style="color: #24292E"> </span><span style="color: #D73A49">===</span><span style="color: #005CC5">0</span><span style="color: #24292E">))((</span><span style="color: #E36209">xs</span><span style="color: #24292E">, </span><span style="color: #E36209">x</span><span style="color: #24292E">) </span><span style="color: #D73A49">=&gt;</span><span style="color: #24292E"> {</span></span>
<span class=line><span style="color: #24292E">  xs.</span><span style="color: #6F42C1">push</span><span style="color: #24292E">(x);</span></span>
<span class=line><span style="color: #24292E">  </span><span style="color: #D73A49">return</span><span style="color: #24292E"> xs;</span></span>
<span class=line><span style="color: #24292E">});</span></span></code></pre></div><div class=shiki-dark><pre class=shiki style="background-color: #0d1117"><code><span class=line><span style="color: #D2A8FF">mapping</span><span style="color: #C9D1D9">(</span><span style="color: #FFA657">x</span><span style="color: #C9D1D9"> </span><span style="color: #FF7B72">=&gt;</span><span style="color: #C9D1D9"> x </span><span style="color: #FF7B72">+</span><span style="color: #C9D1D9"> </span><span style="color: #79C0FF">1</span><span style="color: #C9D1D9">)(</span><span style="color: #D2A8FF">filtering</span><span style="color: #C9D1D9">(</span><span style="color: #FFA657">x</span><span style="color: #C9D1D9"> </span><span style="color: #FF7B72">=&gt;</span><span style="color: #C9D1D9"> x </span><span style="color: #FF7B72">%</span><span style="color: #C9D1D9"> </span><span style="color: #79C0FF">2</span><span style="color: #C9D1D9"> </span><span style="color: #FF7B72">===</span><span style="color: #79C0FF">0</span><span style="color: #C9D1D9">))((</span><span style="color: #FFA657">xs</span><span style="color: #C9D1D9">, </span><span style="color: #FFA657">x</span><span style="color: #C9D1D9">) </span><span style="color: #FF7B72">=&gt;</span><span style="color: #C9D1D9"> {</span></span>
<span class=line><span style="color: #C9D1D9">  xs.</span><span style="color: #D2A8FF">push</span><span style="color: #C9D1D9">(x);</span></span>
<span class=line><span style="color: #C9D1D9">  </span><span style="color: #FF7B72">return</span><span style="color: #C9D1D9"> xs;</span></span>
<span class=line><span style="color: #C9D1D9">});</span></span></code></pre></div>
</code></pre><p>因此我们用一个 reduce 就可以完成：</p><pre><code class=language-js><div class=shiki-light><pre class=shiki style="background-color: #ffffff"><code><span class=line><span style="color: #24292E">[</span><span style="color: #005CC5">0</span><span style="color: #24292E">, </span><span style="color: #005CC5">1</span><span style="color: #24292E">, </span><span style="color: #005CC5">2</span><span style="color: #24292E">, </span><span style="color: #005CC5">3</span><span style="color: #24292E">, </span><span style="color: #005CC5">4</span><span style="color: #24292E">, </span><span style="color: #005CC5">5</span><span style="color: #24292E">, </span><span style="color: #005CC5">6</span><span style="color: #24292E">, </span><span style="color: #005CC5">7</span><span style="color: #24292E">, </span><span style="color: #005CC5">8</span><span style="color: #24292E">, </span><span style="color: #005CC5">9</span><span style="color: #24292E">]</span></span>
<span class=line><span style="color: #24292E">  .</span><span style="color: #6F42C1">reduce</span><span style="color: #24292E">(</span></span>
<span class=line><span style="color: #24292E">    </span><span style="color: #6F42C1">mapping</span><span style="color: #24292E">(</span><span style="color: #E36209">x</span><span style="color: #24292E"> </span><span style="color: #D73A49">=&gt;</span><span style="color: #24292E"> x </span><span style="color: #D73A49">+</span><span style="color: #24292E"> </span><span style="color: #005CC5">1</span><span style="color: #24292E">)(</span><span style="color: #6F42C1">filtering</span><span style="color: #24292E">(</span><span style="color: #E36209">x</span><span style="color: #24292E"> </span><span style="color: #D73A49">=&gt;</span><span style="color: #24292E"> x </span><span style="color: #D73A49">%</span><span style="color: #24292E"> </span><span style="color: #005CC5">2</span><span style="color: #24292E"> </span><span style="color: #D73A49">===</span><span style="color: #24292E"> </span><span style="color: #005CC5">0</span><span style="color: #24292E">)((</span><span style="color: #E36209">xs</span><span style="color: #24292E">, </span><span style="color: #E36209">x</span><span style="color: #24292E">) </span><span style="color: #D73A49">=&gt;</span><span style="color: #24292E"> {</span></span>
<span class=line><span style="color: #24292E">      xs.</span><span style="color: #6F42C1">push</span><span style="color: #24292E">(x);</span></span>
<span class=line><span style="color: #24292E">      </span><span style="color: #D73A49">return</span><span style="color: #24292E"> xs;</span></span>
<span class=line><span style="color: #24292E">    })),</span></span>
<span class=line><span style="color: #24292E">    []);</span></span>
<span class=line><span style="color: #6A737D">// [2, 4, 6, 8, 10]</span></span></code></pre></div><div class=shiki-dark><pre class=shiki style="background-color: #0d1117"><code><span class=line><span style="color: #C9D1D9">[</span><span style="color: #79C0FF">0</span><span style="color: #C9D1D9">, </span><span style="color: #79C0FF">1</span><span style="color: #C9D1D9">, </span><span style="color: #79C0FF">2</span><span style="color: #C9D1D9">, </span><span style="color: #79C0FF">3</span><span style="color: #C9D1D9">, </span><span style="color: #79C0FF">4</span><span style="color: #C9D1D9">, </span><span style="color: #79C0FF">5</span><span style="color: #C9D1D9">, </span><span style="color: #79C0FF">6</span><span style="color: #C9D1D9">, </span><span style="color: #79C0FF">7</span><span style="color: #C9D1D9">, </span><span style="color: #79C0FF">8</span><span style="color: #C9D1D9">, </span><span style="color: #79C0FF">9</span><span style="color: #C9D1D9">]</span></span>
<span class=line><span style="color: #C9D1D9">  .</span><span style="color: #D2A8FF">reduce</span><span style="color: #C9D1D9">(</span></span>
<span class=line><span style="color: #C9D1D9">    </span><span style="color: #D2A8FF">mapping</span><span style="color: #C9D1D9">(</span><span style="color: #FFA657">x</span><span style="color: #C9D1D9"> </span><span style="color: #FF7B72">=&gt;</span><span style="color: #C9D1D9"> x </span><span style="color: #FF7B72">+</span><span style="color: #C9D1D9"> </span><span style="color: #79C0FF">1</span><span style="color: #C9D1D9">)(</span><span style="color: #D2A8FF">filtering</span><span style="color: #C9D1D9">(</span><span style="color: #FFA657">x</span><span style="color: #C9D1D9"> </span><span style="color: #FF7B72">=&gt;</span><span style="color: #C9D1D9"> x </span><span style="color: #FF7B72">%</span><span style="color: #C9D1D9"> </span><span style="color: #79C0FF">2</span><span style="color: #C9D1D9"> </span><span style="color: #FF7B72">===</span><span style="color: #C9D1D9"> </span><span style="color: #79C0FF">0</span><span style="color: #C9D1D9">)((</span><span style="color: #FFA657">xs</span><span style="color: #C9D1D9">, </span><span style="color: #FFA657">x</span><span style="color: #C9D1D9">) </span><span style="color: #FF7B72">=&gt;</span><span style="color: #C9D1D9"> {</span></span>
<span class=line><span style="color: #C9D1D9">      xs.</span><span style="color: #D2A8FF">push</span><span style="color: #C9D1D9">(x);</span></span>
<span class=line><span style="color: #C9D1D9">      </span><span style="color: #FF7B72">return</span><span style="color: #C9D1D9"> xs;</span></span>
<span class=line><span style="color: #C9D1D9">    })),</span></span>
<span class=line><span style="color: #C9D1D9">    []);</span></span>
<span class=line><span style="color: #8B949E">// [2, 4, 6, 8, 10]</span></span></code></pre></div>
</code></pre><p>为了更好的可读性，我们用 Ramda 来改写一下：</p><pre><code class=language-js><div class=shiki-light><pre class=shiki style="background-color: #ffffff"><code><span class=line><span style="color: #D73A49">const</span><span style="color: #24292E"> </span><span style="color: #005CC5">xform</span><span style="color: #24292E"> </span><span style="color: #D73A49">=</span><span style="color: #24292E"> </span><span style="color: #005CC5">R</span><span style="color: #24292E">.</span><span style="color: #6F42C1">compose</span><span style="color: #24292E">(</span></span>
<span class=line><span style="color: #24292E">  </span><span style="color: #6F42C1">mapping</span><span style="color: #24292E">(</span><span style="color: #E36209">x</span><span style="color: #24292E"> </span><span style="color: #D73A49">=&gt;</span><span style="color: #24292E"> x </span><span style="color: #D73A49">+</span><span style="color: #24292E"> </span><span style="color: #005CC5">1</span><span style="color: #24292E">),</span></span>
<span class=line><span style="color: #24292E">  </span><span style="color: #6F42C1">filtering</span><span style="color: #24292E">(</span><span style="color: #E36209">x</span><span style="color: #24292E"> </span><span style="color: #D73A49">=&gt;</span><span style="color: #24292E"> x </span><span style="color: #D73A49">%</span><span style="color: #24292E"> </span><span style="color: #005CC5">2</span><span style="color: #24292E"> </span><span style="color: #D73A49">===</span><span style="color: #24292E"> </span><span style="color: #005CC5">0</span><span style="color: #24292E">),</span></span>
<span class=line><span style="color: #24292E">);</span></span>
<span class=line></span>
<span class=line><span style="color: #24292E">[</span><span style="color: #005CC5">0</span><span style="color: #24292E">, </span><span style="color: #005CC5">1</span><span style="color: #24292E">, </span><span style="color: #005CC5">2</span><span style="color: #24292E">, </span><span style="color: #005CC5">3</span><span style="color: #24292E">, </span><span style="color: #005CC5">4</span><span style="color: #24292E">, </span><span style="color: #005CC5">5</span><span style="color: #24292E">, </span><span style="color: #005CC5">6</span><span style="color: #24292E">, </span><span style="color: #005CC5">7</span><span style="color: #24292E">, </span><span style="color: #005CC5">8</span><span style="color: #24292E">, </span><span style="color: #005CC5">9</span><span style="color: #24292E">]</span></span>
<span class=line><span style="color: #24292E">  .</span><span style="color: #6F42C1">reduce</span><span style="color: #24292E">(</span><span style="color: #6F42C1">xform</span><span style="color: #24292E">((</span><span style="color: #E36209">xs</span><span style="color: #24292E">, </span><span style="color: #E36209">x</span><span style="color: #24292E">) </span><span style="color: #D73A49">=&gt;</span><span style="color: #24292E"> {</span></span>
<span class=line><span style="color: #24292E">    xs.</span><span style="color: #6F42C1">push</span><span style="color: #24292E">(x);</span></span>
<span class=line><span style="color: #24292E">    </span><span style="color: #D73A49">return</span><span style="color: #24292E"> xs;</span></span>
<span class=line><span style="color: #24292E">  }), []);</span></span>
<span class=line><span style="color: #6A737D">// [2, 4, 6, 8, 10]</span></span></code></pre></div><div class=shiki-dark><pre class=shiki style="background-color: #0d1117"><code><span class=line><span style="color: #FF7B72">const</span><span style="color: #C9D1D9"> </span><span style="color: #79C0FF">xform</span><span style="color: #C9D1D9"> </span><span style="color: #FF7B72">=</span><span style="color: #C9D1D9"> </span><span style="color: #79C0FF">R</span><span style="color: #C9D1D9">.</span><span style="color: #D2A8FF">compose</span><span style="color: #C9D1D9">(</span></span>
<span class=line><span style="color: #C9D1D9">  </span><span style="color: #D2A8FF">mapping</span><span style="color: #C9D1D9">(</span><span style="color: #FFA657">x</span><span style="color: #C9D1D9"> </span><span style="color: #FF7B72">=&gt;</span><span style="color: #C9D1D9"> x </span><span style="color: #FF7B72">+</span><span style="color: #C9D1D9"> </span><span style="color: #79C0FF">1</span><span style="color: #C9D1D9">),</span></span>
<span class=line><span style="color: #C9D1D9">  </span><span style="color: #D2A8FF">filtering</span><span style="color: #C9D1D9">(</span><span style="color: #FFA657">x</span><span style="color: #C9D1D9"> </span><span style="color: #FF7B72">=&gt;</span><span style="color: #C9D1D9"> x </span><span style="color: #FF7B72">%</span><span style="color: #C9D1D9"> </span><span style="color: #79C0FF">2</span><span style="color: #C9D1D9"> </span><span style="color: #FF7B72">===</span><span style="color: #C9D1D9"> </span><span style="color: #79C0FF">0</span><span style="color: #C9D1D9">),</span></span>
<span class=line><span style="color: #C9D1D9">);</span></span>
<span class=line></span>
<span class=line><span style="color: #C9D1D9">[</span><span style="color: #79C0FF">0</span><span style="color: #C9D1D9">, </span><span style="color: #79C0FF">1</span><span style="color: #C9D1D9">, </span><span style="color: #79C0FF">2</span><span style="color: #C9D1D9">, </span><span style="color: #79C0FF">3</span><span style="color: #C9D1D9">, </span><span style="color: #79C0FF">4</span><span style="color: #C9D1D9">, </span><span style="color: #79C0FF">5</span><span style="color: #C9D1D9">, </span><span style="color: #79C0FF">6</span><span style="color: #C9D1D9">, </span><span style="color: #79C0FF">7</span><span style="color: #C9D1D9">, </span><span style="color: #79C0FF">8</span><span style="color: #C9D1D9">, </span><span style="color: #79C0FF">9</span><span style="color: #C9D1D9">]</span></span>
<span class=line><span style="color: #C9D1D9">  .</span><span style="color: #D2A8FF">reduce</span><span style="color: #C9D1D9">(</span><span style="color: #D2A8FF">xform</span><span style="color: #C9D1D9">((</span><span style="color: #FFA657">xs</span><span style="color: #C9D1D9">, </span><span style="color: #FFA657">x</span><span style="color: #C9D1D9">) </span><span style="color: #FF7B72">=&gt;</span><span style="color: #C9D1D9"> {</span></span>
<span class=line><span style="color: #C9D1D9">    xs.</span><span style="color: #D2A8FF">push</span><span style="color: #C9D1D9">(x);</span></span>
<span class=line><span style="color: #C9D1D9">    </span><span style="color: #FF7B72">return</span><span style="color: #C9D1D9"> xs;</span></span>
<span class=line><span style="color: #C9D1D9">  }), []);</span></span>
<span class=line><span style="color: #8B949E">// [2, 4, 6, 8, 10]</span></span></code></pre></div>
</code></pre><p>最后将其封装到一个 transduce function：</p><pre><code class=language-js><div class=shiki-light><pre class=shiki style="background-color: #ffffff"><code><span class=line><span style="color: #D73A49">const</span><span style="color: #24292E"> </span><span style="color: #6F42C1">transduce</span><span style="color: #24292E"> </span><span style="color: #D73A49">=</span><span style="color: #24292E"> (</span><span style="color: #E36209">xform</span><span style="color: #24292E">, </span><span style="color: #E36209">reducing</span><span style="color: #24292E">, </span><span style="color: #E36209">initial</span><span style="color: #24292E">, </span><span style="color: #E36209">input</span><span style="color: #24292E">) </span><span style="color: #D73A49">=&gt;</span><span style="color: #24292E"> input.</span><span style="color: #6F42C1">reduce</span><span style="color: #24292E">(</span><span style="color: #6F42C1">xform</span><span style="color: #24292E">(reducing), initial);</span></span></code></pre></div><div class=shiki-dark><pre class=shiki style="background-color: #0d1117"><code><span class=line><span style="color: #FF7B72">const</span><span style="color: #C9D1D9"> </span><span style="color: #D2A8FF">transduce</span><span style="color: #C9D1D9"> </span><span style="color: #FF7B72">=</span><span style="color: #C9D1D9"> (</span><span style="color: #FFA657">xform</span><span style="color: #C9D1D9">, </span><span style="color: #FFA657">reducing</span><span style="color: #C9D1D9">, </span><span style="color: #FFA657">initial</span><span style="color: #C9D1D9">, </span><span style="color: #FFA657">input</span><span style="color: #C9D1D9">) </span><span style="color: #FF7B72">=&gt;</span><span style="color: #C9D1D9"> input.</span><span style="color: #D2A8FF">reduce</span><span style="color: #C9D1D9">(</span><span style="color: #D2A8FF">xform</span><span style="color: #C9D1D9">(reducing), initial);</span></span></code></pre></div>
</code></pre><p>就可以随意应用在更复杂的例子中而获得更高的效率：</p><pre><code class=language-js><div class=shiki-light><pre class=shiki style="background-color: #ffffff"><code><span class=line><span style="color: #D73A49">const</span><span style="color: #24292E"> </span><span style="color: #6F42C1">square</span><span style="color: #24292E"> </span><span style="color: #D73A49">=</span><span style="color: #24292E"> </span><span style="color: #E36209">x</span><span style="color: #24292E"> </span><span style="color: #D73A49">=&gt;</span><span style="color: #24292E"> x </span><span style="color: #D73A49">*</span><span style="color: #24292E"> x;</span></span>
<span class=line></span>
<span class=line><span style="color: #D73A49">const</span><span style="color: #24292E"> </span><span style="color: #005CC5">xform</span><span style="color: #24292E"> </span><span style="color: #D73A49">=</span><span style="color: #24292E"> </span><span style="color: #005CC5">R</span><span style="color: #24292E">.</span><span style="color: #6F42C1">compose</span><span style="color: #24292E">(</span></span>
<span class=line><span style="color: #24292E">  </span><span style="color: #6F42C1">filtering</span><span style="color: #24292E">(</span><span style="color: #E36209">x</span><span style="color: #24292E"> </span><span style="color: #D73A49">=&gt;</span><span style="color: #24292E"> x </span><span style="color: #D73A49">%</span><span style="color: #24292E"> </span><span style="color: #005CC5">2</span><span style="color: #24292E"> </span><span style="color: #D73A49">===</span><span style="color: #24292E"> </span><span style="color: #005CC5">0</span><span style="color: #24292E">),</span></span>
<span class=line><span style="color: #24292E">  </span><span style="color: #6F42C1">filtering</span><span style="color: #24292E">(</span><span style="color: #E36209">x</span><span style="color: #24292E"> </span><span style="color: #D73A49">=&gt;</span><span style="color: #24292E"> x </span><span style="color: #D73A49">&lt;</span><span style="color: #24292E"> </span><span style="color: #005CC5">10</span><span style="color: #24292E">),</span></span>
<span class=line><span style="color: #24292E">  </span><span style="color: #6F42C1">mapping</span><span style="color: #24292E">(square),</span></span>
<span class=line><span style="color: #24292E">  </span><span style="color: #6F42C1">mapping</span><span style="color: #24292E">(</span><span style="color: #E36209">x</span><span style="color: #24292E"> </span><span style="color: #D73A49">=&gt;</span><span style="color: #24292E"> x </span><span style="color: #D73A49">+</span><span style="color: #24292E"> </span><span style="color: #005CC5">1</span><span style="color: #24292E">));</span></span>
<span class=line></span>
<span class=line><span style="color: #6F42C1">transduce</span><span style="color: #24292E">(xform, (</span><span style="color: #E36209">xs</span><span style="color: #24292E">, </span><span style="color: #E36209">x</span><span style="color: #24292E">) </span><span style="color: #D73A49">=&gt;</span><span style="color: #24292E"> {</span></span>
<span class=line><span style="color: #24292E">  xs.</span><span style="color: #6F42C1">push</span><span style="color: #24292E">(x);</span></span>
<span class=line><span style="color: #24292E">  </span><span style="color: #D73A49">return</span><span style="color: #24292E"> xs;</span></span>
<span class=line><span style="color: #24292E">}, [], [</span><span style="color: #005CC5">0</span><span style="color: #24292E">, </span><span style="color: #005CC5">1</span><span style="color: #24292E">, </span><span style="color: #005CC5">2</span><span style="color: #24292E">, </span><span style="color: #005CC5">3</span><span style="color: #24292E">, </span><span style="color: #005CC5">4</span><span style="color: #24292E">, </span><span style="color: #005CC5">5</span><span style="color: #24292E">, </span><span style="color: #005CC5">6</span><span style="color: #24292E">, </span><span style="color: #005CC5">7</span><span style="color: #24292E">, </span><span style="color: #005CC5">8</span><span style="color: #24292E">, </span><span style="color: #005CC5">9</span><span style="color: #24292E">]);</span></span>
<span class=line><span style="color: #6A737D">// [1, 5, 17, 37, 65]</span></span>
<span class=line></span>
<span class=line><span style="color: #6F42C1">transduce</span><span style="color: #24292E">(xform, (</span><span style="color: #E36209">sum</span><span style="color: #24292E">, </span><span style="color: #E36209">x</span><span style="color: #24292E">) </span><span style="color: #D73A49">=&gt;</span><span style="color: #24292E"> sum </span><span style="color: #D73A49">+</span><span style="color: #24292E"> x, </span><span style="color: #005CC5">0</span><span style="color: #24292E">, [</span><span style="color: #005CC5">0</span><span style="color: #24292E">, </span><span style="color: #005CC5">1</span><span style="color: #24292E">, </span><span style="color: #005CC5">2</span><span style="color: #24292E">, </span><span style="color: #005CC5">3</span><span style="color: #24292E">, </span><span style="color: #005CC5">4</span><span style="color: #24292E">, </span><span style="color: #005CC5">5</span><span style="color: #24292E">, </span><span style="color: #005CC5">6</span><span style="color: #24292E">, </span><span style="color: #005CC5">7</span><span style="color: #24292E">, </span><span style="color: #005CC5">8</span><span style="color: #24292E">, </span><span style="color: #005CC5">9</span><span style="color: #24292E">]);</span></span>
<span class=line><span style="color: #6A737D">// 30</span></span></code></pre></div><div class=shiki-dark><pre class=shiki style="background-color: #0d1117"><code><span class=line><span style="color: #FF7B72">const</span><span style="color: #C9D1D9"> </span><span style="color: #D2A8FF">square</span><span style="color: #C9D1D9"> </span><span style="color: #FF7B72">=</span><span style="color: #C9D1D9"> </span><span style="color: #FFA657">x</span><span style="color: #C9D1D9"> </span><span style="color: #FF7B72">=&gt;</span><span style="color: #C9D1D9"> x </span><span style="color: #FF7B72">*</span><span style="color: #C9D1D9"> x;</span></span>
<span class=line></span>
<span class=line><span style="color: #FF7B72">const</span><span style="color: #C9D1D9"> </span><span style="color: #79C0FF">xform</span><span style="color: #C9D1D9"> </span><span style="color: #FF7B72">=</span><span style="color: #C9D1D9"> </span><span style="color: #79C0FF">R</span><span style="color: #C9D1D9">.</span><span style="color: #D2A8FF">compose</span><span style="color: #C9D1D9">(</span></span>
<span class=line><span style="color: #C9D1D9">  </span><span style="color: #D2A8FF">filtering</span><span style="color: #C9D1D9">(</span><span style="color: #FFA657">x</span><span style="color: #C9D1D9"> </span><span style="color: #FF7B72">=&gt;</span><span style="color: #C9D1D9"> x </span><span style="color: #FF7B72">%</span><span style="color: #C9D1D9"> </span><span style="color: #79C0FF">2</span><span style="color: #C9D1D9"> </span><span style="color: #FF7B72">===</span><span style="color: #C9D1D9"> </span><span style="color: #79C0FF">0</span><span style="color: #C9D1D9">),</span></span>
<span class=line><span style="color: #C9D1D9">  </span><span style="color: #D2A8FF">filtering</span><span style="color: #C9D1D9">(</span><span style="color: #FFA657">x</span><span style="color: #C9D1D9"> </span><span style="color: #FF7B72">=&gt;</span><span style="color: #C9D1D9"> x </span><span style="color: #FF7B72">&lt;</span><span style="color: #C9D1D9"> </span><span style="color: #79C0FF">10</span><span style="color: #C9D1D9">),</span></span>
<span class=line><span style="color: #C9D1D9">  </span><span style="color: #D2A8FF">mapping</span><span style="color: #C9D1D9">(square),</span></span>
<span class=line><span style="color: #C9D1D9">  </span><span style="color: #D2A8FF">mapping</span><span style="color: #C9D1D9">(</span><span style="color: #FFA657">x</span><span style="color: #C9D1D9"> </span><span style="color: #FF7B72">=&gt;</span><span style="color: #C9D1D9"> x </span><span style="color: #FF7B72">+</span><span style="color: #C9D1D9"> </span><span style="color: #79C0FF">1</span><span style="color: #C9D1D9">));</span></span>
<span class=line></span>
<span class=line><span style="color: #D2A8FF">transduce</span><span style="color: #C9D1D9">(xform, (</span><span style="color: #FFA657">xs</span><span style="color: #C9D1D9">, </span><span style="color: #FFA657">x</span><span style="color: #C9D1D9">) </span><span style="color: #FF7B72">=&gt;</span><span style="color: #C9D1D9"> {</span></span>
<span class=line><span style="color: #C9D1D9">  xs.</span><span style="color: #D2A8FF">push</span><span style="color: #C9D1D9">(x);</span></span>
<span class=line><span style="color: #C9D1D9">  </span><span style="color: #FF7B72">return</span><span style="color: #C9D1D9"> xs;</span></span>
<span class=line><span style="color: #C9D1D9">}, [], [</span><span style="color: #79C0FF">0</span><span style="color: #C9D1D9">, </span><span style="color: #79C0FF">1</span><span style="color: #C9D1D9">, </span><span style="color: #79C0FF">2</span><span style="color: #C9D1D9">, </span><span style="color: #79C0FF">3</span><span style="color: #C9D1D9">, </span><span style="color: #79C0FF">4</span><span style="color: #C9D1D9">, </span><span style="color: #79C0FF">5</span><span style="color: #C9D1D9">, </span><span style="color: #79C0FF">6</span><span style="color: #C9D1D9">, </span><span style="color: #79C0FF">7</span><span style="color: #C9D1D9">, </span><span style="color: #79C0FF">8</span><span style="color: #C9D1D9">, </span><span style="color: #79C0FF">9</span><span style="color: #C9D1D9">]);</span></span>
<span class=line><span style="color: #8B949E">// [1, 5, 17, 37, 65]</span></span>
<span class=line></span>
<span class=line><span style="color: #D2A8FF">transduce</span><span style="color: #C9D1D9">(xform, (</span><span style="color: #FFA657">sum</span><span style="color: #C9D1D9">, </span><span style="color: #FFA657">x</span><span style="color: #C9D1D9">) </span><span style="color: #FF7B72">=&gt;</span><span style="color: #C9D1D9"> sum </span><span style="color: #FF7B72">+</span><span style="color: #C9D1D9"> x, </span><span style="color: #79C0FF">0</span><span style="color: #C9D1D9">, [</span><span style="color: #79C0FF">0</span><span style="color: #C9D1D9">, </span><span style="color: #79C0FF">1</span><span style="color: #C9D1D9">, </span><span style="color: #79C0FF">2</span><span style="color: #C9D1D9">, </span><span style="color: #79C0FF">3</span><span style="color: #C9D1D9">, </span><span style="color: #79C0FF">4</span><span style="color: #C9D1D9">, </span><span style="color: #79C0FF">5</span><span style="color: #C9D1D9">, </span><span style="color: #79C0FF">6</span><span style="color: #C9D1D9">, </span><span style="color: #79C0FF">7</span><span style="color: #C9D1D9">, </span><span style="color: #79C0FF">8</span><span style="color: #C9D1D9">, </span><span style="color: #79C0FF">9</span><span style="color: #C9D1D9">]);</span></span>
<span class=line><span style="color: #8B949E">// 30</span></span></code></pre></div>
</code></pre><h3 id=ref>ref</h3><ul><li><p><a href=http://elbenshira.com/blog/understanding-transducers/ >http://elbenshira.com/blog/understanding-transducers/</a></p></li><li><p><a href=http://blog.cognitect.com/blog/2014/8/6/transducers-are-coming>http://blog.cognitect.com/blog/2014/8/6/transducers-are-coming</a></p></li><li><p><a href=https://github.com/cognitect-labs/transducers-js>https://github.com/cognitect-labs/transducers-js</a></p></li><li><p><a href=https://medium.com/@roman01la/understanding-transducers-in-javascript-3500d3bd9624>https://medium.com/@roman01la/understanding-transducers-in-javascript-3500d3bd9624</a></p></li></ul></div><div class=footer><hr><div class=footer-link><a href=/archive><i class="fa fa-archive" aria-hidden=true></i></a><a target=_blank href=https://twitter.com/chow_won><i class="fa fa-twitter" aria-hidden=true></i></a> <a target=_blank href=https://github.com/zoubingwu><i class="fa fa-github" aria-hidden=true></i></a> <a target=_blank href=mailto:zoubingwu@gmail.com><i class="fa fa-envelope" aria-hidden=true></i></a></div>© 2016-2021 zoubingwu. All rights reserved.</div></div></body></html>