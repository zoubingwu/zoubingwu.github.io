<!DOCTYPE html><html lang=en><head><meta charset=utf-8><meta name=viewport content="width=device-width,initial-scale=1"><meta name=keywords content=blog,html,css,javascript,react,vue,nodejs><meta name=description content="zoubingwu 个人博客, zoubingwu's blog"><link href=/assets/images/favicon.ico rel=bookmark type=image/x-icon><link href=/assets/images/favicon.ico rel=icon type=image/x-icon><link href=/assets/images/favicon.ico rel="shortcut icon" type=image/x-icon><link rel=stylesheet href=/assets/css/main.css type=text/css><link rel=preconnect href=https://fonts.googleapis.com><link rel=preconnect href=https://fonts.gstatic.com crossorigin><link rel=stylesheet href=https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.min.css integrity="sha512-SfTiTlX6kk+qitfevl/7LibUOeJWlt9rbyDn92a1DqWOw9vWG2MFoays0sgObmWazO5BQPiFucnnEAjpAB+/Sw==" crossorigin=anonymous referrerpolicy=no-referrer><link href="https://fonts.googleapis.com/css2?family=Merriweather:wght@300&display=swap" rel=stylesheet><link rel=alternate type=application/rss+xml title="RSS Feed for zoubingwu's blog" href=/feed.xml><title>typescript and type system | https://zoubingwu.com</title><meta property=og:title content="typescript and type system | https://zoubingwu.com"><meta property=og:locale content=en_US><meta name=description content="concepts in typescript and type system"><meta property=og:description content="concepts in typescript and type system"><link rel=canonical href=https://zoubingwu.com/2021-10-09/typescript-and-type-system><meta property=og:url content=https://zoubingwu.com/2021-10-09/typescript-and-type-system><meta property=og:site_name content="zoubingwu's blog"><meta property=og:type content=article><meta property=article:published_time content=2021-10-09T16:12:33.000Z><meta name=twitter:card content=summary><meta property=twitter:title content="typescript and type system | https://zoubingwu.com"><script defer=defer src=https://static.cloudflareinsights.com/beacon.min.js data-cf-beacon='{"token": "76b8468271b24f3180af2110f74841c3"}'></script></head><body><main class=content-container><div class=post><div class=post-title>typescript and type system</div><span class=post-date><time>9 Oct 2021</time></span><div class=post-tag><ul><li><a><span><i class="fa fa-paperclip" aria-hidden=true></i>typescript</span></a></li></ul></div><p>This blog is an excerpt from a previous presentation given within the company, summarizing some basic concepts of type systems.</p><h2 id=why-do-we-need-type-systems>Why do we need type systems</h2><h3 id=distinguishing-code-from-data>Distinguishing code from data</h3><p>At the low-level hardware and machine code level, there is no distinction between program logic and data. However, if the system makes a mistake in distinguishing them, errors can occur. Take the notorious eval function in JavaScript as a less typical example, it is easy to mix up strings and code logic.</p><pre><code class=language-js><pre class=shiki style="background-color: #282c34"><code><span class=line><span style="color: #E5C07B">console</span><span style="color: #ABB2BF">.</span><span style="color: #61AFEF">log</span><span style="color: #ABB2BF">(</span><span style="color: #56B6C2">eval</span><span style="color: #ABB2BF">(</span><span style="color: #98C379">&quot;40 + 2&quot;</span><span style="color: #ABB2BF">)) </span><span style="color: #7F848E; font-style: italic">// OK</span></span>
<span class=line><span style="color: #E5C07B">console</span><span style="color: #ABB2BF">.</span><span style="color: #61AFEF">log</span><span style="color: #ABB2BF">(</span><span style="color: #56B6C2">eval</span><span style="color: #ABB2BF">(</span><span style="color: #98C379">&quot;Hello world!&quot;</span><span style="color: #ABB2BF">)) </span><span style="color: #7F848E; font-style: italic">// Error!</span></span></code></pre>
</code></pre><h3 id=interpreting-data-giving-more-meaning-to-types>Interpreting data, giving more meaning to types</h3><p>For machines, types restrict the set of valid values that a variable can accept, while also providing many safety attributes (such as modifiers like private and protected).</p><p>For humans, types give a more easily understandable and memorable meaning, making programs more readable and easier to understand by others.</p><p>From a logical perspective, adhering to a type system is like a logical proof, providing logical rigor for the correct execution of a program, thus providing assurance for correctness and safety.</p><p>For example, for a 16-bit binary sequence in hardware, its meaning can be an unsigned 16-bit integer or a signed 16-bit integer, so the corresponding uint16 and int16 types and their respective value ranges are different.</p><h2 id=classification-of-type-systems>Classification of type systems</h2><p>There is no strict classification criteria for type systems, but from different dimensions and indicators, we can make some rough classifications. For example:</p><ul><li>Strong vs. Weak</li><li>Static vs. Dynamic</li><li>Manifest vs. Inferred</li><li>Nominal vs. Structural</li></ul><p>etc., let’s briefly introduce the meanings of each classification.</p><h3 id=strong-vs-weak>Strong vs. Weak</h3><p>Strong and weak typing mainly describe the strictness of type constraints when implementing them. Weak type systems often implicitly try to convert a value from its actual type to the expected type when using the value, while strong types only do minimal (or even no) implicit type conversion. Like JavaScript, it is obviously weakly typed, a typical example is the double equal sign:</p><pre><code class=language-js><pre class=shiki style="background-color: #282c34"><code><span class=line><span style="color: #98C379">&quot;42&quot;</span><span style="color: #ABB2BF"> </span><span style="color: #56B6C2">==</span><span style="color: #ABB2BF"> </span><span style="color: #D19A66">42</span><span style="color: #ABB2BF"> </span><span style="color: #7F848E; font-style: italic">// true</span></span></code></pre>
</code></pre><h3 id=static-vs-dynamic>Static vs. Dynamic</h3><p>The difference between static and dynamic typing mainly lies in the actual type checking. Dynamic typing defers type checking to runtime, so runtime errors may occur, for example, in JavaScript, if we call a method that does not exist on an object, it will throw an error <code>Uncaught TypeError: xxx is not a function</code>. On the other hand, static typing can determine types and perform type checking at compile time, and if there is a mismatch, a compile error will occur.</p><p>The main advantage of static typing is that it allows these errors to be discovered at compile time, thereby avoiding runtime issues.</p><p>Seeing this, it is natural to understand that a more accurate statement would be that TypeScript is a statically typed language, rather than the commonly mistaken term “strongly typed language”.</p><h3 id=manifest-vs-inferred>Manifest vs. Inferred</h3><p>The difference between these two mainly lies in the need for explicit type declarations or the ability to infer types through compiler type inference to reduce active type declarations. For development efficiency and experience, most languages support type inference.</p><h3 id=nominal-vs-structural>Nominal vs. Structural</h3><p>Nominal type systems compare the types themselves and have very strong consistency requirements. Structural type systems compare the shape of type definitions. There is also a concept called Duck typing, I don’t care what it is, as long as it can swim like a duck, walk like a duck, and quack like a duck, then I consider it a duck.</p><p>C# uses a Nominal type system:</p><pre><code class=language-csharp><pre class=shiki style="background-color: #282c34"><code><span class=line><span style="color: #C678DD">public</span><span style="color: #ABB2BF"> </span><span style="color: #C678DD">class</span><span style="color: #ABB2BF"> </span><span style="color: #E5C07B">Foo</span><span style="color: #ABB2BF"> {</span></span>
<span class=line><span style="color: #ABB2BF">    </span><span style="color: #C678DD">public</span><span style="color: #ABB2BF"> </span><span style="color: #C678DD">string</span><span style="color: #ABB2BF"> Name { </span><span style="color: #C678DD">get</span><span style="color: #ABB2BF">; </span><span style="color: #C678DD">set</span><span style="color: #ABB2BF">; }</span></span>
<span class=line><span style="color: #ABB2BF">    </span><span style="color: #C678DD">public</span><span style="color: #ABB2BF"> </span><span style="color: #C678DD">int</span><span style="color: #ABB2BF"> Id { </span><span style="color: #C678DD">get</span><span style="color: #ABB2BF">; </span><span style="color: #C678DD">set</span><span style="color: #ABB2BF">; }</span></span>
<span class=line><span style="color: #ABB2BF">}</span></span>
<span class=line></span>
<span class=line><span style="color: #C678DD">public</span><span style="color: #ABB2BF"> </span><span style="color: #C678DD">class</span><span style="color: #ABB2BF"> </span><span style="color: #E5C07B">Bar</span><span style="color: #ABB2BF"> {</span></span>
<span class=line><span style="color: #ABB2BF">    </span><span style="color: #C678DD">public</span><span style="color: #ABB2BF"> </span><span style="color: #C678DD">string</span><span style="color: #ABB2BF"> Name { </span><span style="color: #C678DD">get</span><span style="color: #ABB2BF">; </span><span style="color: #C678DD">set</span><span style="color: #ABB2BF">; }</span></span>
<span class=line><span style="color: #ABB2BF">    </span><span style="color: #C678DD">public</span><span style="color: #ABB2BF"> </span><span style="color: #C678DD">int</span><span style="color: #ABB2BF"> Id { </span><span style="color: #C678DD">get</span><span style="color: #ABB2BF">; </span><span style="color: #C678DD">set</span><span style="color: #ABB2BF">; }</span></span>
<span class=line><span style="color: #ABB2BF">}</span></span>
<span class=line></span>
<span class=line><span style="color: #E5C07B">Foo</span><span style="color: #ABB2BF"> </span><span style="color: #E06C75">foo</span><span style="color: #ABB2BF"> </span><span style="color: #56B6C2">=</span><span style="color: #ABB2BF"> </span><span style="color: #C678DD">new</span><span style="color: #ABB2BF"> </span><span style="color: #E5C07B">Foo</span><span style="color: #ABB2BF">(); </span><span style="color: #7F848E; font-style: italic">// Ok</span></span>
<span class=line><span style="color: #E5C07B">Bar</span><span style="color: #ABB2BF"> </span><span style="color: #E06C75">bar</span><span style="color: #ABB2BF"> </span><span style="color: #56B6C2">=</span><span style="color: #ABB2BF"> </span><span style="color: #C678DD">new</span><span style="color: #ABB2BF"> </span><span style="color: #E5C07B">Foo</span><span style="color: #ABB2BF">(); </span><span style="color: #7F848E; font-style: italic">// Error!</span></span></code></pre>
</code></pre><p>TypeScript uses a Structural type system:</p><pre><code class=language-ts><pre class=shiki style="background-color: #282c34"><code><span class=line><span style="color: #C678DD">class</span><span style="color: #ABB2BF"> </span><span style="color: #E5C07B">Foo</span><span style="color: #ABB2BF"> {</span></span>
<span class=line><span style="color: #ABB2BF">    </span><span style="color: #61AFEF">method</span><span style="color: #ABB2BF">() {}</span></span>
<span class=line><span style="color: #ABB2BF">}</span></span>
<span class=line></span>
<span class=line><span style="color: #C678DD">class</span><span style="color: #ABB2BF"> </span><span style="color: #E5C07B">Bar</span><span style="color: #ABB2BF"> {</span></span>
<span class=line><span style="color: #ABB2BF">    </span><span style="color: #61AFEF">method</span><span style="color: #ABB2BF">() {}</span></span>
<span class=line><span style="color: #ABB2BF">}</span></span>
<span class=line></span>
<span class=line><span style="color: #C678DD">const</span><span style="color: #ABB2BF"> </span><span style="color: #E5C07B">foo</span><span style="color: #ABB2BF">: </span><span style="color: #E5C07B">Foo</span><span style="color: #ABB2BF"> </span><span style="color: #56B6C2">=</span><span style="color: #ABB2BF"> </span><span style="color: #C678DD">new</span><span style="color: #ABB2BF"> </span><span style="color: #61AFEF">Foo</span><span style="color: #ABB2BF">(); </span><span style="color: #7F848E; font-style: italic">// Ok</span></span>
<span class=line><span style="color: #C678DD">const</span><span style="color: #ABB2BF"> </span><span style="color: #E5C07B">bar</span><span style="color: #ABB2BF">: </span><span style="color: #E5C07B">Bar</span><span style="color: #ABB2BF"> </span><span style="color: #56B6C2">=</span><span style="color: #ABB2BF"> </span><span style="color: #E06C75">bew</span><span style="color: #ABB2BF"> </span><span style="color: #61AFEF">Foo</span><span style="color: #ABB2BF">(); </span><span style="color: #7F848E; font-style: italic">// Ok</span></span></code></pre>
</code></pre><h2 id=typescript-type-system>TypeScript type system</h2><p>TS and C# are two programming languages designed by Anders Hejlsberg, and they actually have many similarities. TypeScript was designed as a superset of JavaScript, and naturally had to consider the flexible nature of JS itself. The structural type system in TypeScript is a natural choice.</p><blockquote><p>One of TypeScript’s core principles is that type checking focuses on the shape that values have. This is sometimes called “duck typing” or “structural subtyping”.</p></blockquote><p>TypeScript only checks the shape, the constraints defined by type definitions, which is very similar to the concept of sets. For example, the type Point can be understood as a kind of set:</p><pre><code class=language-ts><pre class=shiki style="background-color: #282c34"><code><span class=line><span style="color: #C678DD">interface</span><span style="color: #ABB2BF"> </span><span style="color: #E5C07B">Point</span><span style="color: #ABB2BF"> {</span></span>
<span class=line><span style="color: #ABB2BF">    </span><span style="color: #E06C75">x</span><span style="color: #ABB2BF">: </span><span style="color: #E5C07B">number</span><span style="color: #ABB2BF">;</span></span>
<span class=line><span style="color: #ABB2BF">    </span><span style="color: #E06C75">y</span><span style="color: #ABB2BF">: </span><span style="color: #E5C07B">number</span><span style="color: #ABB2BF">;</span></span>
<span class=line><span style="color: #ABB2BF">}</span></span></code></pre>
</code></pre><p>It corresponds to the type that fulfills the following conditions, which is the Point type:</p><pre><code class=language-js><pre class=shiki style="background-color: #282c34"><code><span class=line><span style="color: #C678DD">typeof</span><span style="color: #ABB2BF"> </span><span style="color: #E06C75">obj</span><span style="color: #ABB2BF"> </span><span style="color: #56B6C2">===</span><span style="color: #ABB2BF"> </span><span style="color: #98C379">&#39;object&#39;</span><span style="color: #ABB2BF"> </span><span style="color: #56B6C2">&amp;&amp;</span></span>
<span class=line><span style="color: #C678DD">typeof</span><span style="color: #ABB2BF"> </span><span style="color: #E5C07B">obj</span><span style="color: #ABB2BF">.</span><span style="color: #E06C75">x</span><span style="color: #ABB2BF"> </span><span style="color: #56B6C2">===</span><span style="color: #ABB2BF"> </span><span style="color: #98C379">&#39;number&#39;</span><span style="color: #ABB2BF"> </span><span style="color: #56B6C2">&amp;&amp;</span></span>
<span class=line><span style="color: #C678DD">typeof</span><span style="color: #ABB2BF"> </span><span style="color: #E5C07B">obj</span><span style="color: #ABB2BF">.</span><span style="color: #E06C75">y</span><span style="color: #ABB2BF"> </span><span style="color: #56B6C2">===</span><span style="color: #ABB2BF"> </span><span style="color: #98C379">&#39;number&#39;</span></span></code></pre>
</code></pre><p>TypeScript provides a series of basic types, such as <code>string</code>, <code>number</code>, <code>boolean</code>, <code>undefined</code>, <code>null</code>, <code>symbol</code>, etc. By combining these basic types, many derived types can be created, which allows combining multiple sets and giving them meaningful names, such as the derived types Record, tuple, enum, etc.</p><p>With sets, there naturally, will be intersection and union, leading to intersection types and union types:</p><pre><code class=language-ts><pre class=shiki style="background-color: #282c34"><code><span class=line><span style="color: #C678DD">interface</span><span style="color: #ABB2BF"> </span><span style="color: #E5C07B">WithName</span><span style="color: #ABB2BF"> {</span></span>
<span class=line><span style="color: #ABB2BF">    </span><span style="color: #E06C75">name</span><span style="color: #ABB2BF">: </span><span style="color: #E5C07B">string</span></span>
<span class=line><span style="color: #ABB2BF">}</span></span>
<span class=line></span>
<span class=line><span style="color: #C678DD">interface</span><span style="color: #ABB2BF"> </span><span style="color: #E5C07B">WithAge</span><span style="color: #ABB2BF"> {</span></span>
<span class=line><span style="color: #ABB2BF">    </span><span style="color: #E06C75">age</span><span style="color: #ABB2BF">: </span><span style="color: #E5C07B">number</span></span>
<span class=line><span style="color: #ABB2BF">}</span></span>
<span class=line></span>
<span class=line><span style="color: #C678DD">type</span><span style="color: #ABB2BF"> </span><span style="color: #E5C07B">People</span><span style="color: #ABB2BF"> </span><span style="color: #56B6C2">=</span><span style="color: #ABB2BF"> </span><span style="color: #E5C07B">WithName</span><span style="color: #ABB2BF"> &amp; </span><span style="color: #E5C07B">WithAge</span></span>
<span class=line><span style="color: #C678DD">type</span><span style="color: #ABB2BF"> </span><span style="color: #E5C07B">NumberOrString</span><span style="color: #ABB2BF"> </span><span style="color: #56B6C2">=</span><span style="color: #ABB2BF"> </span><span style="color: #E5C07B">string</span><span style="color: #ABB2BF"> | </span><span style="color: #E5C07B">number</span></span></code></pre>
</code></pre><h3 id=algebraic-data-type>Algebraic Data Type</h3><p>There is a concept called <code>Algebraic Data Type (ADT)</code>. ADT is a type formed by combining other types.</p><p>Two typical ways of combining types are product types and sum types.</p><ul><li>Product types combine types such as AxBxC, it contains one value from ABC, examples are records and tuples.</li><li>Sum types combine types such as A+B+C, it contains only one value from ABC, a typical example is a discriminated union.</li></ul><h3 id=type-narrowing>Type Narrowing</h3><p>For a large and complex type, we often need to narrow it down step by step to determine more specific type judgments, for example:</p><pre><code class=language-ts><pre class=shiki style="background-color: #282c34"><code><span class=line><span style="color: #C678DD">function</span><span style="color: #ABB2BF"> </span><span style="color: #61AFEF">triple</span><span style="color: #ABB2BF">(</span><span style="color: #E06C75; font-style: italic">input</span><span style="color: #ABB2BF">: </span><span style="color: #E5C07B">number</span><span style="color: #ABB2BF"> | </span><span style="color: #E5C07B">string</span><span style="color: #ABB2BF">): </span><span style="color: #E5C07B">number</span><span style="color: #ABB2BF"> | </span><span style="color: #E5C07B">string</span><span style="color: #ABB2BF"> {</span></span>
<span class=line><span style="color: #ABB2BF">    </span><span style="color: #C678DD">if</span><span style="color: #ABB2BF"> (</span><span style="color: #C678DD">typeof</span><span style="color: #ABB2BF"> </span><span style="color: #E06C75">input</span><span style="color: #ABB2BF"> </span><span style="color: #56B6C2">===</span><span style="color: #ABB2BF"> </span><span style="color: #98C379">&#39;number&#39;</span><span style="color: #ABB2BF">) {</span></span>
<span class=line><span style="color: #ABB2BF">        </span><span style="color: #C678DD">return</span><span style="color: #ABB2BF"> </span><span style="color: #E06C75">input</span><span style="color: #ABB2BF"> </span><span style="color: #56B6C2">*</span><span style="color: #ABB2BF"> </span><span style="color: #D19A66">3</span></span>
<span class=line><span style="color: #ABB2BF">    } </span><span style="color: #C678DD">else</span><span style="color: #ABB2BF"> {</span></span>
<span class=line><span style="color: #ABB2BF">        </span><span style="color: #C678DD">return</span><span style="color: #ABB2BF"> </span><span style="color: #E5C07B">input</span><span style="color: #ABB2BF">.</span><span style="color: #61AFEF">repeat</span><span style="color: #ABB2BF">(</span><span style="color: #D19A66">3</span><span style="color: #ABB2BF">)</span></span>
<span class=line><span style="color: #ABB2BF">    }</span></span>
<span class=line><span style="color: #ABB2BF">}</span></span></code></pre>
</code></pre><p>TypeScript provides various means to achieve Type Narrowing, such as the typeof operator, the instanceof operator, equality comparison, control flow analysis, and type predicates.</p><p>Here is a typical example of Type Narrowing implemented using a discriminated union:</p><pre><code class=language-ts><pre class=shiki style="background-color: #282c34"><code><span class=line><span style="color: #C678DD">type</span><span style="color: #ABB2BF"> </span><span style="color: #E5C07B">Square</span><span style="color: #ABB2BF"> </span><span style="color: #56B6C2">=</span><span style="color: #ABB2BF"> {</span></span>
<span class=line><span style="color: #ABB2BF">    </span><span style="color: #E06C75">kind</span><span style="color: #ABB2BF">: </span><span style="color: #98C379">&#39;square&#39;</span></span>
<span class=line><span style="color: #ABB2BF">    </span><span style="color: #E06C75">size</span><span style="color: #ABB2BF">: </span><span style="color: #E5C07B">number</span></span>
<span class=line><span style="color: #ABB2BF">}</span></span>
<span class=line></span>
<span class=line></span>
<span class=line><span style="color: #C678DD">type</span><span style="color: #ABB2BF"> </span><span style="color: #E5C07B">Rectangle</span><span style="color: #ABB2BF"> </span><span style="color: #56B6C2">=</span><span style="color: #ABB2BF"> {</span></span>
<span class=line><span style="color: #ABB2BF">    </span><span style="color: #E06C75">kind</span><span style="color: #ABB2BF">: </span><span style="color: #98C379">&#39;rectangle&#39;</span></span>
<span class=line><span style="color: #ABB2BF">    </span><span style="color: #E06C75">width</span><span style="color: #ABB2BF">: </span><span style="color: #E5C07B">number</span></span>
<span class=line><span style="color: #ABB2BF">    </span><span style="color: #E06C75">height</span><span style="color: #ABB2BF">: </span><span style="color: #E5C07B">number</span></span>
<span class=line><span style="color: #ABB2BF">}</span></span>
<span class=line></span>
<span class=line><span style="color: #C678DD">type</span><span style="color: #ABB2BF"> </span><span style="color: #E5C07B">Circle</span><span style="color: #ABB2BF"> </span><span style="color: #56B6C2">=</span><span style="color: #ABB2BF"> {</span></span>
<span class=line><span style="color: #ABB2BF">    </span><span style="color: #E06C75">kind</span><span style="color: #ABB2BF">: </span><span style="color: #98C379">&#39;circle&#39;</span></span>
<span class=line><span style="color: #ABB2BF">    </span><span style="color: #E06C75">radius</span><span style="color: #ABB2BF">: </span><span style="color: #E5C07B">number</span></span>
<span class=line><span style="color: #ABB2BF">}</span></span>
<span class=line></span>
<span class=line><span style="color: #C678DD">type</span><span style="color: #ABB2BF"> </span><span style="color: #E5C07B">Shape</span><span style="color: #ABB2BF"> </span><span style="color: #56B6C2">=</span><span style="color: #ABB2BF"> </span><span style="color: #E5C07B">Square</span><span style="color: #ABB2BF"> | </span><span style="color: #E5C07B">Rectangle</span><span style="color: #ABB2BF"> | </span><span style="color: #E5C07B">Circle</span></span>
<span class=line></span>
<span class=line><span style="color: #C678DD">function</span><span style="color: #ABB2BF"> </span><span style="color: #61AFEF">area</span><span style="color: #ABB2BF">(</span><span style="color: #E06C75; font-style: italic">shape</span><span style="color: #ABB2BF">: </span><span style="color: #E5C07B">Shape</span><span style="color: #ABB2BF">): </span><span style="color: #E5C07B">number</span><span style="color: #ABB2BF"> {</span></span>
<span class=line><span style="color: #ABB2BF">    </span><span style="color: #C678DD">switch</span><span style="color: #ABB2BF"> (</span><span style="color: #E5C07B">shape</span><span style="color: #ABB2BF">.</span><span style="color: #E06C75">kind</span><span style="color: #ABB2BF">) {</span></span>
<span class=line><span style="color: #ABB2BF">        </span><span style="color: #C678DD">case</span><span style="color: #ABB2BF"> </span><span style="color: #98C379">&#39;square&#39;</span><span style="color: #ABB2BF">:</span></span>
<span class=line><span style="color: #ABB2BF">            </span><span style="color: #C678DD">return</span><span style="color: #ABB2BF"> </span><span style="color: #E5C07B">shape</span><span style="color: #ABB2BF">.</span><span style="color: #E06C75">size</span><span style="color: #ABB2BF"> </span><span style="color: #56B6C2">*</span><span style="color: #ABB2BF"> </span><span style="color: #E5C07B">shape</span><span style="color: #ABB2BF">.</span><span style="color: #E06C75">size</span></span>
<span class=line><span style="color: #ABB2BF">        </span><span style="color: #C678DD">case</span><span style="color: #ABB2BF"> </span><span style="color: #98C379">&#39;rectangle&#39;</span><span style="color: #ABB2BF">:</span></span>
<span class=line><span style="color: #ABB2BF">            </span><span style="color: #C678DD">return</span><span style="color: #ABB2BF"> </span><span style="color: #E5C07B">shape</span><span style="color: #ABB2BF">.</span><span style="color: #E06C75">width</span><span style="color: #ABB2BF"> </span><span style="color: #56B6C2">*</span><span style="color: #ABB2BF"> </span><span style="color: #E5C07B">shape</span><span style="color: #ABB2BF">.</span><span style="color: #E06C75">height</span></span>
<span class=line><span style="color: #ABB2BF">        </span><span style="color: #C678DD">case</span><span style="color: #ABB2BF"> </span><span style="color: #98C379">&#39;circle&#39;</span><span style="color: #ABB2BF">:</span></span>
<span class=line><span style="color: #ABB2BF">            </span><span style="color: #C678DD">return</span><span style="color: #ABB2BF"> </span><span style="color: #E5C07B">Math</span><span style="color: #ABB2BF">.</span><span style="color: #E06C75">Pi</span><span style="color: #ABB2BF"> </span><span style="color: #56B6C2">*</span><span style="color: #ABB2BF"> </span><span style="color: #E5C07B">shape</span><span style="color: #ABB2BF">.</span><span style="color: #E06C75">radius</span><span style="color: #ABB2BF"> </span><span style="color: #56B6C2">*</span><span style="color: #ABB2BF"> </span><span style="color: #E5C07B">shape</span><span style="color: #ABB2BF">.</span><span style="color: #E06C75">radius</span></span>
<span class=line><span style="color: #ABB2BF">    }</span></span>
<span class=line><span style="color: #ABB2BF">}</span></span></code></pre>
</code></pre><p>All types in the union have a common property with literal types. TypeScript considers this to be a discriminated union, and can narrow down the members of the union.</p><blockquote><p>When every type in a union contains a common property with literal types, TypeScript considers that to be a <strong>discriminated union</strong>, and can narrow out the members of the union.</p></blockquote><p>Another trick we can use is the never type to perform an exhaustiveness check on the switch:</p><pre><code class=language-ts><pre class=shiki style="background-color: #282c34"><code><span class=line><span style="color: #C678DD">function</span><span style="color: #ABB2BF"> </span><span style="color: #61AFEF">area</span><span style="color: #ABB2BF">(</span><span style="color: #E06C75; font-style: italic">shape</span><span style="color: #ABB2BF">: </span><span style="color: #E5C07B">Shape</span><span style="color: #ABB2BF">): </span><span style="color: #E5C07B">number</span><span style="color: #ABB2BF"> {</span></span>
<span class=line><span style="color: #ABB2BF">    </span><span style="color: #C678DD">switch</span><span style="color: #ABB2BF"> (</span><span style="color: #E5C07B">shape</span><span style="color: #ABB2BF">.</span><span style="color: #E06C75">kind</span><span style="color: #ABB2BF">) {</span></span>
<span class=line><span style="color: #ABB2BF">        </span><span style="color: #C678DD">case</span><span style="color: #ABB2BF"> </span><span style="color: #98C379">&#39;square&#39;</span><span style="color: #ABB2BF">:</span></span>
<span class=line><span style="color: #ABB2BF">            </span><span style="color: #C678DD">return</span><span style="color: #ABB2BF"> </span><span style="color: #E5C07B">shape</span><span style="color: #ABB2BF">.</span><span style="color: #E06C75">size</span><span style="color: #ABB2BF"> </span><span style="color: #56B6C2">*</span><span style="color: #ABB2BF"> </span><span style="color: #E5C07B">shape</span><span style="color: #ABB2BF">.</span><span style="color: #E06C75">size</span></span>
<span class=line><span style="color: #ABB2BF">        </span><span style="color: #C678DD">case</span><span style="color: #ABB2BF"> </span><span style="color: #98C379">&#39;rectangle&#39;</span><span style="color: #ABB2BF">:</span></span>
<span class=line><span style="color: #ABB2BF">            </span><span style="color: #C678DD">return</span><span style="color: #ABB2BF"> </span><span style="color: #E5C07B">shape</span><span style="color: #ABB2BF">.</span><span style="color: #E06C75">width</span><span style="color: #ABB2BF"> </span><span style="color: #56B6C2">*</span><span style="color: #ABB2BF"> </span><span style="color: #E5C07B">shape</span><span style="color: #ABB2BF">.</span><span style="color: #E06C75">height</span></span>
<span class=line><span style="color: #ABB2BF">        </span><span style="color: #C678DD">case</span><span style="color: #ABB2BF"> </span><span style="color: #98C379">&#39;circle&#39;</span><span style="color: #ABB2BF">:</span></span>
<span class=line><span style="color: #ABB2BF">            </span><span style="color: #C678DD">return</span><span style="color: #ABB2BF"> </span><span style="color: #E5C07B">Math</span><span style="color: #ABB2BF">.</span><span style="color: #E06C75">Pi</span><span style="color: #ABB2BF"> </span><span style="color: #56B6C2">*</span><span style="color: #ABB2BF"> </span><span style="color: #E5C07B">shape</span><span style="color: #ABB2BF">.</span><span style="color: #E06C75">radius</span><span style="color: #ABB2BF"> </span><span style="color: #56B6C2">*</span><span style="color: #ABB2BF"> </span><span style="color: #E5C07B">shape</span><span style="color: #ABB2BF">.</span><span style="color: #E06C75">radius</span></span>
<span class=line><span style="color: #ABB2BF">        </span><span style="color: #C678DD">default</span><span style="color: #ABB2BF">:</span></span>
<span class=line><span style="color: #ABB2BF">            </span><span style="color: #C678DD">const</span><span style="color: #ABB2BF"> </span><span style="color: #E5C07B">_exhaustiveCheck</span><span style="color: #ABB2BF">: </span><span style="color: #E5C07B">never</span><span style="color: #ABB2BF"> </span><span style="color: #56B6C2">=</span><span style="color: #ABB2BF"> </span><span style="color: #E06C75">shape</span></span>
<span class=line><span style="color: #ABB2BF">            </span><span style="color: #C678DD">return</span><span style="color: #ABB2BF"> </span><span style="color: #E06C75">_exhaustiveCheck</span></span>
<span class=line><span style="color: #ABB2BF">    }</span></span>
<span class=line><span style="color: #ABB2BF">}</span></span></code></pre>
</code></pre><h3 id=subtyping>Subtyping</h3><p>If an instance of type T can be safely used anywhere an instance of type S is expected, then we say that S is a subtype of T, and there is a parent-child relationship between the two types. More formally, they must not only meet the syntax correctness but also the behavioral correctness, which is also called Behavioral Subtyping.</p><p>The definition of subtypes mentioned above is Liskov substitution principle, which is also the L in the well-known SOLID principles in object-oriented programming:</p><ul><li>S - Single-responsibility Principle</li><li>O - Open-closed Principle</li><li>L - Liskov Substitution Principle</li><li>I - Interface Segregation Principle</li><li>D - Dependency Inversion Principle</li></ul><p>For subtypes, there are also nominal vs. structural subtyping. Nominal subtyping requires explicit declaration of one type being a subtype of another using syntax like <code>class Triangle extends Shape</code>, while structural subtyping only requires one type to structurally contain all the collections of another type (clearly in TS, it belongs to the latter, but we can still achieve the former using symbols).</p><pre><code class=language-ts><pre class=shiki style="background-color: #282c34"><code><span class=line><span style="color: #E06C75">decalare</span><span style="color: #ABB2BF"> </span><span style="color: #C678DD">const</span><span style="color: #ABB2BF"> </span><span style="color: #E5C07B">TriangleType</span><span style="color: #ABB2BF">: </span><span style="color: #E5C07B">unique</span><span style="color: #ABB2BF"> </span><span style="color: #E5C07B">symbol</span></span>
<span class=line><span style="color: #E06C75">decalare</span><span style="color: #ABB2BF"> </span><span style="color: #C678DD">const</span><span style="color: #ABB2BF"> </span><span style="color: #E5C07B">ShapeType</span><span style="color: #ABB2BF">: </span><span style="color: #E5C07B">unique</span><span style="color: #ABB2BF"> </span><span style="color: #E5C07B">symbol</span></span>
<span class=line></span>
<span class=line><span style="color: #C678DD">class</span><span style="color: #ABB2BF"> </span><span style="color: #E5C07B">Triangle</span><span style="color: #ABB2BF"> {</span></span>
<span class=line><span style="color: #ABB2BF">    [</span><span style="color: #E06C75">TriangleType</span><span style="color: #ABB2BF">]: </span><span style="color: #E5C07B">void</span></span>
<span class=line><span style="color: #ABB2BF">}</span></span>
<span class=line></span>
<span class=line><span style="color: #C678DD">class</span><span style="color: #ABB2BF"> </span><span style="color: #E5C07B">Shape</span><span style="color: #ABB2BF"> {</span></span>
<span class=line><span style="color: #ABB2BF">    [</span><span style="color: #E06C75">ShapeType</span><span style="color: #ABB2BF">]: </span><span style="color: #E5C07B">void</span></span>
<span class=line><span style="color: #ABB2BF">}</span></span>
<span class=line></span>
<span class=line><span style="color: #C678DD">class</span><span style="color: #ABB2BF"> </span><span style="color: #E5C07B">Triangle2</span><span style="color: #ABB2BF"> </span><span style="color: #C678DD">extends</span><span style="color: #ABB2BF"> </span><span style="color: #E5C07B">Shape</span><span style="color: #ABB2BF"> {}</span></span>
<span class=line></span>
<span class=line><span style="color: #C678DD">const</span><span style="color: #ABB2BF"> </span><span style="color: #61AFEF">shouldAcceptAnyShape</span><span style="color: #ABB2BF"> </span><span style="color: #56B6C2">=</span><span style="color: #ABB2BF"> (</span><span style="color: #E06C75; font-style: italic">shape</span><span style="color: #ABB2BF">: </span><span style="color: #E5C07B">Shape</span><span style="color: #ABB2BF">) </span><span style="color: #C678DD">=&gt;</span><span style="color: #ABB2BF"> {}</span></span>
<span class=line></span>
<span class=line><span style="color: #61AFEF">shouldAcceptAnyShape</span><span style="color: #ABB2BF">(</span><span style="color: #C678DD">new</span><span style="color: #ABB2BF"> </span><span style="color: #61AFEF">Triangle</span><span style="color: #ABB2BF">()) </span><span style="color: #7F848E; font-style: italic">// Error</span></span>
<span class=line><span style="color: #61AFEF">shouldAcceptAnyShape</span><span style="color: #ABB2BF">(</span><span style="color: #C678DD">new</span><span style="color: #ABB2BF"> </span><span style="color: #61AFEF">Triangle2</span><span style="color: #ABB2BF">()) </span><span style="color: #7F848E; font-style: italic">// Ok</span></span></code></pre>
</code></pre><p>In extreme cases, a type may be a parent type of any other type, which is called a top-level type. In TypeScript, it is <code>unknown</code>. A type may also be a subtype of any other type, which is called a bottom-level type. In TS, it is <code>never</code>.</p><h3 id=unknown-vs-any>unknown vs any</h3><p>Although any value can be assigned to unknown and any, when using variables of these two types, any can bypass type checking, while unknown cannot:</p><pre><code class=language-ts><pre class=shiki style="background-color: #282c34"><code><span class=line><span style="color: #C678DD">interface</span><span style="color: #ABB2BF"> </span><span style="color: #E5C07B">User</span><span style="color: #ABB2BF"> {</span></span>
<span class=line><span style="color: #ABB2BF">    </span><span style="color: #E06C75">name</span><span style="color: #ABB2BF">: </span><span style="color: #E5C07B">string</span></span>
<span class=line><span style="color: #ABB2BF">}</span></span>
<span class=line></span>
<span class=line><span style="color: #C678DD">const</span><span style="color: #ABB2BF"> </span><span style="color: #E5C07B">str</span><span style="color: #ABB2BF"> </span><span style="color: #56B6C2">=</span><span style="color: #ABB2BF"> </span><span style="color: #D19A66">JSON</span><span style="color: #ABB2BF">.</span><span style="color: #56B6C2">stringify</span><span style="color: #ABB2BF">({ </span><span style="color: #E06C75">name</span><span style="color: #ABB2BF">: </span><span style="color: #98C379">&#39;jack&#39;</span><span style="color: #ABB2BF"> })</span></span>
<span class=line></span>
<span class=line><span style="color: #C678DD">const</span><span style="color: #ABB2BF"> </span><span style="color: #61AFEF">deserialize</span><span style="color: #ABB2BF"> </span><span style="color: #56B6C2">=</span><span style="color: #ABB2BF"> (</span><span style="color: #E06C75; font-style: italic">input</span><span style="color: #ABB2BF">: </span><span style="color: #E5C07B">string</span><span style="color: #ABB2BF">): </span><span style="color: #E5C07B">unknown</span><span style="color: #ABB2BF"> </span><span style="color: #C678DD">=&gt;</span><span style="color: #ABB2BF"> </span><span style="color: #D19A66">JSON</span><span style="color: #ABB2BF">.</span><span style="color: #56B6C2">parse</span><span style="color: #ABB2BF">(</span><span style="color: #E06C75">input</span><span style="color: #ABB2BF">)</span></span>
<span class=line></span>
<span class=line><span style="color: #C678DD">const</span><span style="color: #ABB2BF"> </span><span style="color: #61AFEF">greet</span><span style="color: #ABB2BF"> </span><span style="color: #56B6C2">=</span><span style="color: #ABB2BF"> (</span><span style="color: #E06C75; font-style: italic">u</span><span style="color: #ABB2BF">: </span><span style="color: #E5C07B">user</span><span style="color: #ABB2BF">) </span><span style="color: #C678DD">=&gt;</span><span style="color: #ABB2BF"> </span><span style="color: #E5C07B">console</span><span style="color: #ABB2BF">.</span><span style="color: #61AFEF">log</span><span style="color: #ABB2BF">(</span><span style="color: #98C379">`hello </span><span style="color: #C678DD">${</span><span style="color: #E5C07B">u</span><span style="color: #ABB2BF">.</span><span style="color: #E06C75">name</span><span style="color: #C678DD">}</span><span style="color: #98C379">`</span><span style="color: #ABB2BF">)</span></span>
<span class=line></span>
<span class=line><span style="color: #C678DD">const</span><span style="color: #ABB2BF"> </span><span style="color: #61AFEF">isUser</span><span style="color: #ABB2BF"> </span><span style="color: #56B6C2">=</span><span style="color: #ABB2BF"> (</span><span style="color: #E06C75; font-style: italic">u</span><span style="color: #ABB2BF">: </span><span style="color: #E5C07B">any</span><span style="color: #ABB2BF">): </span><span style="color: #E06C75; font-style: italic">u</span><span style="color: #ABB2BF"> is </span><span style="color: #E5C07B">User</span><span style="color: #ABB2BF"> </span><span style="color: #C678DD">=&gt;</span><span style="color: #ABB2BF"> </span><span style="color: #E06C75">u</span><span style="color: #ABB2BF"> </span><span style="color: #56B6C2">&amp;&amp;</span><span style="color: #ABB2BF"> </span><span style="color: #C678DD">typeof</span><span style="color: #ABB2BF"> </span><span style="color: #E5C07B">u</span><span style="color: #ABB2BF">.</span><span style="color: #E06C75">name</span><span style="color: #ABB2BF"> </span><span style="color: #56B6C2">===</span><span style="color: #ABB2BF"> </span><span style="color: #98C379">&#39;string&#39;</span></span>
<span class=line></span>
<span class=line><span style="color: #C678DD">let</span><span style="color: #ABB2BF"> </span><span style="color: #E06C75">usr</span><span style="color: #ABB2BF"> </span><span style="color: #56B6C2">=</span><span style="color: #ABB2BF"> </span><span style="color: #61AFEF">deserialize</span><span style="color: #ABB2BF">(</span><span style="color: #E06C75">str</span><span style="color: #ABB2BF">)</span></span>
<span class=line></span>
<span class=line><span style="color: #61AFEF">greet</span><span style="color: #ABB2BF">(</span><span style="color: #E06C75">usr</span><span style="color: #ABB2BF">) </span><span style="color: #7F848E; font-style: italic">// Error</span></span>
<span class=line></span>
<span class=line><span style="color: #C678DD">if</span><span style="color: #ABB2BF"> (</span><span style="color: #61AFEF">isUser</span><span style="color: #ABB2BF">(</span><span style="color: #E06C75">usr</span><span style="color: #ABB2BF">)) {</span></span>
<span class=line><span style="color: #ABB2BF">    </span><span style="color: #61AFEF">greet</span><span style="color: #ABB2BF">(</span><span style="color: #E06C75">usr</span><span style="color: #ABB2BF">) </span><span style="color: #7F848E; font-style: italic">// Ok</span></span>
<span class=line><span style="color: #ABB2BF">}</span></span></code></pre>
</code></pre><p>If a type retains the parent-child relationship of its underlying type, it is said to have covariance.</p><p>For example, <code>LinkedList&lt;T&gt;</code> has covariance because <code>LinkedList&lt;Triangle&gt;</code> and <code>LinkedList&lt;Shape&gt;</code> still maintain the parent-child relationship between <code>Triangle</code> and <code>Shape</code>.</p><p>Similarly, the relationship of the underlying type may be reversed, in that case, it is called contravariance. If the relationship of the underlying type is uncertain or can be ignored, it is called invariance.</p><h3 id=type-programming>Type Programming</h3><p>In addition to set operations, we can also perform programming operations on types. To reuse calculation logic more conveniently, type variables and generics are introduced. Generics can be understood as variables at the type level, which can capture the actual type when called, and with the help of the simplified type operators provided by TS, such as keyof, in, etc., type conversion functions can be implemented.</p><p>Among them, conditional types are the most difficult, in the general form of <code>T extends U ? X : Y</code>, similar to the ternary expression in JavaScript, to describe non-uniform types.</p><p>With conditional types, we can give the type system stronger expressive power and achieve some constraints that were previously impossible, such as without conditional types:</p><pre><code class=language-ts><pre class=shiki style="background-color: #282c34"><code><span class=line><span style="color: #C678DD">function</span><span style="color: #ABB2BF"> </span><span style="color: #61AFEF">process</span><span style="color: #ABB2BF">(</span><span style="color: #E06C75; font-style: italic">text</span><span style="color: #ABB2BF">: </span><span style="color: #E5C07B">string</span><span style="color: #ABB2BF"> | </span><span style="color: #E5C07B">null</span><span style="color: #ABB2BF">): </span><span style="color: #E5C07B">string</span><span style="color: #ABB2BF"> | </span><span style="color: #E5C07B">null</span><span style="color: #ABB2BF"> {</span></span>
<span class=line><span style="color: #ABB2BF">    </span><span style="color: #C678DD">return</span><span style="color: #ABB2BF"> </span><span style="color: #E06C75">text</span><span style="color: #ABB2BF"> </span><span style="color: #56B6C2">&amp;&amp;</span><span style="color: #ABB2BF"> </span><span style="color: #E5C07B">text</span><span style="color: #ABB2BF">.</span><span style="color: #61AFEF">replace</span><span style="color: #ABB2BF">(</span><span style="color: #98C379">&#39;/f/g&#39;</span><span style="color: #ABB2BF">, </span><span style="color: #98C379">&#39;p&#39;</span><span style="color: #ABB2BF">)</span></span>
<span class=line><span style="color: #ABB2BF">}</span></span>
<span class=line></span>
<span class=line><span style="color: #61AFEF">process</span><span style="color: #ABB2BF">(</span><span style="color: #98C379">&#39;foo&#39;</span><span style="color: #ABB2BF">).</span><span style="color: #61AFEF">toUpperCase</span><span style="color: #ABB2BF">() </span><span style="color: #7F848E; font-style: italic">// Error!</span></span></code></pre>
</code></pre><p>With conditional types, we can improve the constraints by checking if the input is a valid string, and if so, the return is guaranteed to be a valid string:</p><pre><code class=language-ts><pre class=shiki style="background-color: #282c34"><code><span class=line><span style="color: #C678DD">function</span><span style="color: #ABB2BF"> </span><span style="color: #61AFEF">process</span><span style="color: #ABB2BF">&lt;</span><span style="color: #E5C07B">T</span><span style="color: #ABB2BF"> </span><span style="color: #C678DD">extends</span><span style="color: #ABB2BF"> </span><span style="color: #E5C07B">string</span><span style="color: #ABB2BF"> | </span><span style="color: #E5C07B">null</span><span style="color: #ABB2BF">&gt;(</span><span style="color: #E06C75; font-style: italic">text</span><span style="color: #ABB2BF">: </span><span style="color: #E5C07B">T</span><span style="color: #ABB2BF">): </span><span style="color: #E5C07B">T</span><span style="color: #ABB2BF"> </span><span style="color: #C678DD">extends</span><span style="color: #ABB2BF"> </span><span style="color: #E5C07B">string</span><span style="color: #ABB2BF"> </span><span style="color: #C678DD">?</span><span style="color: #ABB2BF"> </span><span style="color: #E5C07B">string</span><span style="color: #ABB2BF"> </span><span style="color: #C678DD">:</span><span style="color: #ABB2BF"> </span><span style="color: #E5C07B">null</span><span style="color: #ABB2BF"> {</span></span>
<span class=line><span style="color: #ABB2BF">    </span><span style="color: #C678DD">return</span><span style="color: #ABB2BF"> </span><span style="color: #E06C75">text</span><span style="color: #ABB2BF"> </span><span style="color: #56B6C2">&amp;&amp;</span><span style="color: #ABB2BF"> </span><span style="color: #E5C07B">text</span><span style="color: #ABB2BF">.</span><span style="color: #61AFEF">replace</span><span style="color: #ABB2BF">(</span><span style="color: #98C379">&#39;/f/g&#39;</span><span style="color: #ABB2BF">, </span><span style="color: #98C379">&#39;p&#39;</span><span style="color: #ABB2BF">)</span></span>
<span class=line><span style="color: #ABB2BF">}</span></span>
<span class=line></span>
<span class=line><span style="color: #61AFEF">process</span><span style="color: #ABB2BF">(</span><span style="color: #98C379">&#39;foo&#39;</span><span style="color: #ABB2BF">).</span><span style="color: #61AFEF">toUpperCase</span><span style="color: #ABB2BF">() </span><span style="color: #7F848E; font-style: italic">// Ok</span></span>
<span class=line><span style="color: #61AFEF">process</span><span style="color: #ABB2BF">(</span><span style="color: #D19A66">null</span><span style="color: #ABB2BF">).</span><span style="color: #61AFEF">toUpperCase</span><span style="color: #ABB2BF">() </span><span style="color: #7F848E; font-style: italic">// Error</span></span></code></pre>
</code></pre><p>Nested conditional types are possible, and when T is a union type, conditional types can be expanded:</p><pre><code class=language-ts><pre class=shiki style="background-color: #282c34"><code><span class=line><span style="color: #ABB2BF">(</span><span style="color: #E5C07B">A</span><span style="color: #ABB2BF"> </span><span style="color: #56B6C2">|</span><span style="color: #ABB2BF"> </span><span style="color: #E5C07B">B</span><span style="color: #ABB2BF">) </span><span style="color: #E06C75">extends</span><span style="color: #ABB2BF"> </span><span style="color: #E5C07B">U</span><span style="color: #ABB2BF"> </span><span style="color: #C678DD">?</span><span style="color: #ABB2BF"> </span><span style="color: #E5C07B">X</span><span style="color: #ABB2BF"> </span><span style="color: #C678DD">:</span><span style="color: #ABB2BF"> </span><span style="color: #E5C07B">Y</span><span style="color: #ABB2BF"> </span><span style="color: #56B6C2">==&gt;</span><span style="color: #ABB2BF"> (</span><span style="color: #E5C07B">A</span><span style="color: #ABB2BF"> </span><span style="color: #E06C75">extends</span><span style="color: #ABB2BF"> </span><span style="color: #E5C07B">U</span><span style="color: #ABB2BF"> </span><span style="color: #C678DD">?</span><span style="color: #ABB2BF"> </span><span style="color: #E5C07B">X</span><span style="color: #ABB2BF"> </span><span style="color: #C678DD">:</span><span style="color: #ABB2BF"> </span><span style="color: #E5C07B">Y</span><span style="color: #ABB2BF">) </span><span style="color: #56B6C2">|</span><span style="color: #ABB2BF"> (</span><span style="color: #E5C07B">B</span><span style="color: #ABB2BF"> </span><span style="color: #E06C75">extends</span><span style="color: #ABB2BF"> </span><span style="color: #E5C07B">U</span><span style="color: #ABB2BF"> </span><span style="color: #C678DD">?</span><span style="color: #ABB2BF"> </span><span style="color: #E5C07B">X</span><span style="color: #ABB2BF"> </span><span style="color: #C678DD">:</span><span style="color: #ABB2BF"> </span><span style="color: #E5C07B">Y</span><span style="color: #ABB2BF">)</span></span></code></pre>
</code></pre><p>With the help of conditional types, we can create more utility types, such as the built-in Exclude and Extract types in TS.</p><h3 id=type-level-space-vs-value-level-space>Type-level space vs. Value-level space</h3><p>TS creates another parallel type declaration space during variable declarations. Understanding the isolation and connection between the two spaces helps to stay clear in various messy declarations.</p><ul><li>Types can refer to each other and be assigned to each other in their own space, but cannot be used as variables.</li><li>Variables can refer to each other and be assigned to each other in their own space, but cannot be used as types.</li><li>Declarations in the two spaces can even have the same name.</li></ul><p>Types in their own space also achieve <a href=https://github.com/Microsoft/TypeScript/issues/14833#issuecomment-536713761>Turing completeness</a>. Type gymnastics are perfectly capable of solving any computable problems at the type level. Some people have even implemented a <a href=https://github.com/Microsoft/TypeScript/issues/14833#issuecomment-536713761>mathematical expression</a> calculation in the type space.</p><h2 id=ref>Ref</h2><ul><li><a href=https://en.wikipedia.org/wiki/Nominal_type_system>Nominal type system</a></li><li><a href=https://en.wikipedia.org/wiki/Structural_type_system>Structural type system</a></li><li><a href=https://book.douban.com/subject/35325133/ >编程与类型系统- 图书</a></li><li><a href=https://zhuanlan.zhihu.com/p/389379296>浅谈Typescript（一）：什么是Typescript？ - 知乎</a></li><li><a href=https://zhuanlan.zhihu.com/p/64446259>浅谈TypeScript 类型系统- 知乎</a></li><li><a href=https://zhuanlan.zhihu.com/p/384172236>读懂类型体操：TypeScript 类型元编程基础入门</a></li></ul></div><div class=footer><hr><div class=footer-link><a href=/archive aria-label="Read more about all archives"><i class="fa fa-archive" aria-hidden=true></i> </a><a target=_blank href=https://twitter.com/chow_won aria-label="Read more on twitter"><i class="fa fa-twitter" aria-hidden=true></i></a> <a target=_blank href=https://github.com/zoubingwu aria-label="Read more on github"><i class="fa fa-github" aria-hidden=true></i> </a><a target=_blank href=mailto:zoubingwu@gmail.com aria-label=Email><i class="fa fa-envelope" aria-hidden=true></i></a></div>© 2016-2024 zoubingwu. All rights reserved.</div></main></body></html>